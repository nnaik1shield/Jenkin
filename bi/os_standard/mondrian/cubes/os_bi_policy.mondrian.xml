<!--
	$Modified By By: Ssingh
	$Date:   01 December 2022  $
-->
<Schema name="Oneshield BI - Policy">

  <Dimension visible="true" highCardinality="false" name="Dim_Broker" caption="Broker">
    <Hierarchy visible="true" hasAll="true" primaryKey="PE_PARTNER_ID">
      <Table name="BI_DIM_PARTNER_ENTITY">
      </Table>
	  <Level name="Broker Status" column="PE_PARTNER_STATUS" nameColumn="PE_PARTNER_STATUS" ordinalColumn="PE_PARTNER_STATUS" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Broker Status">
	</Level>
      <Level name="Broker" column="PE_PARTNER_NAME" nameColumn="PE_PARTNER_NAME" visible="true" caption="Broker" ordinalColumn="PE_PARTNER_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Broker Name">
	</Level>
    </Hierarchy>
  </Dimension>
  
  <Dimension visible="false" highCardinality="false" name="Dim_Underwriter">
    <Hierarchy visible="true" hasAll="true" allMemberName="All Underwriters" primaryKey="UD_USER_ID">
      <Table name="BI_DIM_USER_DETAIL" alias="Underwriter">
      </Table>
      <Level name="Underwriter" visible="true" column="UD_USER_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Name of the Underwriter">
      </Level>
    </Hierarchy>
  </Dimension>
  
    <Dimension visible="true" highCardinality="false" name="Dim_Writing_Company">
    <Hierarchy visible="true" hasAll="true" allMemberName="All Writing Companies" primaryKey="PE_PARTNER_ID">
      <Table name="BI_DIM_PARTNER_ENTITY" alias="Writing_Company">
      </Table>
	  <Level name="Writing Company Status" column="PE_PARTNER_STATUS" nameColumn="PE_PARTNER_STATUS" ordinalColumn="PE_PARTNER_STATUS" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Writing Company Status">
	</Level>
     <Level name="Writing Company" column="PE_PARTNER_NAME" nameColumn="PE_PARTNER_NAME" ordinalColumn="PE_PARTNER_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Writing Company Name">
	 <Property name="Writing Company Code" column="PE_PARTNER_CODE" type="String">
        </Property>
	<Property name="Writing Company Parent Name" column="PE_PARTNER_PARENT_NAME" type="String">
        </Property>
	<Property name="Marketing Manager Name" column="PE_PARTNER_MKT_MANAGER_NAME" type="String">
        </Property>
	<Property name="Writing Company Effective Date" column="PE_PARTNER_EFF_DATE" nameColumn="PE_PARTNER_EFF_DATE" ordinalColumn="PE_PARTNER_EFF_DATE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Writing Company Effective Date">
	</Property>
	<Property name="Writing Company Expiry Date" column="PE_PARTNER_EXP_DATE" nameColumn="PE_PARTNER_EXP_DATE" ordinalColumn="PE_PARTNER_EXP_DATE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Writing Company Expiry Date">
	</Property>
	</Level>
    </Hierarchy>
  </Dimension>
  
  <Dimension visible="true" highCardinality="false" name="Dim_Line_of_Business" caption="Line of Business">
    <Hierarchy visible="true" hasAll="true" allMemberName="All Lines" primaryKey="PD_PRODUCT_ID">
      <Table name="BI_DIM_PRODUCT_DETAIL">
      </Table>
      <Level name="Line of Business" visible="true" column="PD_LOB_NAME" nameColumn="PD_LOB_NAME" ordinalColumn="PD_LOB_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Line of Business" description="Line of Business">
      </Level>
      <Level name="Product" visible="false" column="PD_PRODUCT_NAME" nameColumn="PD_PRODUCT_NAME" ordinalColumn="PD_PRODUCT_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Product" description="Product">
      </Level>
    </Hierarchy>
  </Dimension>
  <Dimension highCardinality="false" name="Dim_Policy" caption="Policy Details">
    <Hierarchy hasAll="true" allMemberName="All Policies" primaryKey="POD_POLICY_ID">
      <Table name="BI_DIM_POLICY_DETAIL" alias="DIM_POLICY">
      </Table>
      <Level name="Policy Number" column="POD_POLICY_NUMBER" nameColumn="POD_POLICY_NUMBER" ordinalColumn="POD_POLICY_NUMBER" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Policy Number">
      </Level>
      <Level name="Policy Term" column="POD_POLICY_TERM" nameColumn="POD_POLICY_TERM" ordinalColumn="POD_POLICY_TERM" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Policy Term">
      </Level>
    </Hierarchy>
  </Dimension>
  
  <Dimension visible="true" highCardinality="false" name="Dim_Creator" caption="Creator">
    <Hierarchy visible="true" hasAll="true" allMemberName="All Creators" primaryKey="UD_USER_ID">
      <Table name="BI_DIM_USER_DETAIL" alias="Creator">
      </Table>
      <Level name="Creator Role" visible="true" column="UD_USER_ROLE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Creator Role" description="Creator role name">
      </Level>
      <Level name="Creator User" visible="true" column="UD_USER_NAME" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never" caption="Creator User" description="Name of the Creator">
      </Level>
      
    </Hierarchy>
  </Dimension>
  
  <Dimension visible="true" highCardinality="false" name="Dim_Assignee" caption="Assignee">
    <Hierarchy visible="true" hasAll="true" allMemberName="All Assignee" primaryKey="UD_USER_ID">
      <Table name="BI_DIM_USER_DETAIL" alias="Assignee">
      </Table>
      <Level name="Assignee Role" visible="true" column="UD_USER_ROLE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Assignee Role" description="Assgined User role name">
      </Level>
      <Level name="Assignee User" visible="true" column="UD_USER_NAME" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never" caption="Assignee User" description="Name of the Current Assignee">
      </Level>   
    </Hierarchy>
  </Dimension>
  
  
  <Dimension visible="true" highCardinality="false" name="Dim_Producer">
    <Hierarchy name="Producer" visible="true" hasAll="true" allMemberName="All Producers" primaryKey="PP_PRODUCER_ID">
      <Table name="BI_DIM_PRODUCER_PARTNER">
      </Table>
      <Level name="Producer Name" column="PP_PRODUCER_NAME" nameColumn="PP_PRODUCER_NAME" ordinalColumn="PP_PRODUCER_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Producer Name">
	<Property name="Partner Code" column="PP_PARTNER_CODE" type="String">
        </Property>
	<Property name="Partner Name" column="PP_PARTNER_NAME" type="String">
        </Property>
	<Property name="Partner Parent Name" column="PP_PARTNER_PARENT_NAME" type="String">
        </Property>
	<Property name="Partner Type" column="PP_PARTNER_TYPE" type="String">
        </Property>
	</Level>
    </Hierarchy>
  </Dimension>
  <Dimension visible="true" highCardinality="false" name="Dim_Address" caption="Address">
    <Hierarchy visible="true" hasAll="true" allMemberName="All Countries" primaryKey="AD_ADDRESS_ID">
      <Table name="BI_DIM_ADDRESS_DETAIL">
      </Table>
      <Level name="Country" visible="true" column="AD_COUNTRY_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Country" description="Name of the Country">
	  <Annotations>
    <Annotation name="Data.Role">Geography</Annotation>
    <Annotation name="Geo.Role">country</Annotation>
  </Annotations>
      </Level>
      <Level name="Jurisdiction" visible="true" column="AD_JURISDICTION_NAME" ordinalColumn="JL_JURISDICTION_ID" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Jurisdiction" description="Name of the Jurisdiction">
	  	  <Annotations>
    <Annotation name="Data.Role">Geography</Annotation>
    <Annotation name="Geo.Role">state</Annotation>
  </Annotations>
      </Level>
      <Level name="City" visible="true" column="AD_ADDRESS_CITY" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never" caption="City" description="Name of the City">
	  <Annotations>
    <Annotation name="Data.Role">Geography</Annotation>
    <Annotation name="Geo.Role">city</Annotation>
  </Annotations>
      </Level>
      <Level name="ZipCode" visible="true" column="AD_ADDRESS_ZIP_CODE"  type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Zip Code" description="Zip Code">
	  <Annotations>
    <Annotation name="Data.Role">Geography</Annotation>
    <Annotation name="Geo.Role">zip</Annotation>
  </Annotations>
      </Level>
    </Hierarchy>
  </Dimension>
  
  <!-- New Set -->
  <Dimension visible="true" highCardinality="false" name="UW Policy" caption="UW Policy">
    <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="PT_ID" primaryKeyTable="BI_FACT_POLICY_TRX_DETAIL">
      <Join leftKey="PT_POLICY_ID" rightKey="POD_POLICY_ID">
        <Table name="BI_FACT_POLICY_TRX_DETAIL">
        </Table>
        <Table name="BI_DIM_POLICY_DETAIL" alias="POLICY">
        </Table>
      </Join>
      <Level name="Policy Billing Method" visible="true" table = "POLICY" column="POD_BILLING_METHOD" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Policy Billing Method" description="Policy Billing Method">  
      </Level>
	  <Level name="Policy Number" visible="true" table = "POLICY" column="POD_POLICY_NUMBER" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Policy Number" description="Policy Number">  
      </Level>
    </Hierarchy>
   </Dimension>
   
   <Dimension visible="true" highCardinality="false" name="UW Policy Term" caption="UW Policy Term">
    <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="PT_ID" primaryKeyTable="BI_FACT_POLICY_TRX_DETAIL">
      <Join leftKey="PT_TERM_ID" rightKey="POLT_ID">
        <Table name="BI_FACT_POLICY_TRX_DETAIL">
        </Table>
        <Table name="BI_DIM_POLICY_TERM_DETAIL" alias="POLICY_TERM">
        </Table>
      </Join>
      <Level name="PAS Status" visible="true" table = "POLICY_TERM" column="POLT_PAS_STATUS" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="PAS Status" description="PAS Status">  
	  <Property name="Term Effective Date" table = "POLICY_TERM" column="POLT_EFF_DATE" type="String">
        </Property>
        <Property name="Term Expiration Date" table = "POLICY_TERM" column="POLT_EXP_DATE" type="String">
        </Property>
      </Level>
    </Hierarchy>
  </Dimension>
  
  <Dimension visible="true" highCardinality="false" name="Carrier Branch" caption="Carrier Branch">
    <Hierarchy visible="true" hasAll="true" allMemberName="All Carrier Branches" primaryKey="PE_PARTNER_ID">
      <Table name="BI_DIM_PARTNER_ENTITY" alias="Carrier_Branch">
      </Table>
	  <Level name="Carrier Status" column="PE_PARTNER_STATUS" nameColumn="PE_PARTNER_STATUS" ordinalColumn="PE_PARTNER_STATUS" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Carrier Status">
	</Level>
      <Level name="Carrier Name" column="PE_PARTNER_NAME" nameColumn="PE_PARTNER_NAME" ordinalColumn="PE_PARTNER_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Carrier Name">
	  <Property name="Carrier Code" column="PE_PARTNER_CODE" type="String">
        </Property>
	<Property name="Carrier Parent Name" column="PE_PARTNER_PARENT_NAME" type="String">
        </Property>
	<Property name="Marketing Manager Name" column="PE_PARTNER_MKT_MANAGER_NAME" type="String">
        </Property>
	<Property name="Carrier Effective Date" column="PE_PARTNER_EFF_DATE" type="String" >
	</Property>
	<Property name="Carrier Expiry Date" column="PE_PARTNER_EXP_DATE" type="String" >
	</Property>
	</Level>
    </Hierarchy>
  </Dimension>
  
  <Dimension visible="true" highCardinality="false" name="Writing Company">
    <Hierarchy visible="true" hasAll="true" allMemberName="All Writing Companies" primaryKey="PE_PARTNER_ID">
      <Table name="BI_DIM_PARTNER_ENTITY" alias="Writing_Company">
      </Table>
	  <Level name="Writing Company Status" column="PE_PARTNER_STATUS" nameColumn="PE_PARTNER_STATUS" ordinalColumn="PE_PARTNER_STATUS" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Writing Company Status">
	</Level>
     <Level name="Writing Company" column="PE_PARTNER_NAME" nameColumn="PE_PARTNER_NAME" ordinalColumn="PE_PARTNER_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Writing Company Name">
	 <Property name="Writing Company Code" column="PE_PARTNER_CODE" type="String">
        </Property>
	<Property name="Writing Company Parent Name" column="PE_PARTNER_PARENT_NAME" type="String">
        </Property>
	<Property name="Marketing Manager Name" column="PE_PARTNER_MKT_MANAGER_NAME" type="String">
        </Property>
	<Property name="Writing Company Effective Date" column="PE_PARTNER_EFF_DATE" nameColumn="PE_PARTNER_EFF_DATE" ordinalColumn="PE_PARTNER_EFF_DATE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Writing Company Effective Date">
	</Property>
	<Property name="Writing Company Expiry Date" column="PE_PARTNER_EXP_DATE" nameColumn="PE_PARTNER_EXP_DATE" ordinalColumn="PE_PARTNER_EXP_DATE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Writing Company Expiry Date">
	</Property>
	</Level>
    </Hierarchy>
  </Dimension>
  
  <Dimension visible="true" highCardinality="false" name="Policy Details" caption="Policy Details">
    <Hierarchy visible="true" hasAll="true" allMemberName="Policy Details" primaryKey="PT_ID">
      <Table name="BI_FACT_POLICY_TRX_DETAIL">
      </Table>
      <Level name="Policy Type" visible="true" column="PT_TYPE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Policy Type" description="Policy Type">
        <Property name="Policy Effective Date" column="PT_EFF_DT" type="String">
        </Property>
        <Property name="Policy Processed Date" column="PT_PROCESSED_DT" type="String">
        </Property>
      </Level>
	 </Hierarchy>
  </Dimension>
  
  <Dimension visible="true" highCardinality="false" name="Corrected By Agency" caption="Corrected By Agency">
    <Hierarchy visible="true" hasAll="true" primaryKey="PE_PARTNER_ID">
      <Table name="BI_DIM_PARTNER_ENTITY">
      </Table>
	  <Level name="Agency Status" column="PE_PARTNER_STATUS" nameColumn="PE_PARTNER_STATUS" ordinalColumn="PE_PARTNER_STATUS" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Agency Status">
	</Level>
      <Level name="Agency" column="PE_PARTNER_NAME" nameColumn="PE_PARTNER_NAME" ordinalColumn="PE_PARTNER_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Agency Name">
	  <Property name="Agency Code" column="PE_PARTNER_CODE" type="String">
        </Property>
	<Property name="Agency Parent Name" column="PE_PARTNER_PARENT_NAME" type="String">
        </Property>
	<Property name="Marketing Manager Name" column="PE_PARTNER_MKT_MANAGER_NAME" type="String">
        </Property>
	<Property name="Agency Effective Date" column="PE_PARTNER_EFF_DATE" type="String" >
	</Property>
	<Property name="Agency Expiry Date" column="PE_PARTNER_EXP_DATE" type="String" >
	</Property>
	</Level>
    </Hierarchy>
  </Dimension>
  
  <Dimension visible="true" highCardinality="false" name="Corrected By Underwriter">
    <Hierarchy name="Corrected By Underwriter" visible="true" hasAll="true" primaryKey="UD_USER_ID">
      <Table name="BI_DIM_USER_DETAIL">
      </Table>
      <Level name="Underwriter" visible="true" column="UD_USER_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Name of the Underwriter">
      </Level>
    </Hierarchy>
  </Dimension>
  
  <Dimension visible="true" highCardinality="false" name="Underwriting Rule">
    <Hierarchy visible="true" hasAll="true" allMemberName="All Underwriting Rules" primaryKey="CR_RULE_ID">
      <Table name="BI_DIM_COVERAGE_RULE">
      </Table>
      <Level name="Underwriting Rule Type" visible="true" column="CR_RULE_TYPE_ID" nameColumn="CR_RULE_TYPE_NAME" ordinalColumn="CR_RULE_TYPE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Coverage Rule Type">
      </Level>
      <Level name="Underwriting Rule Message" visible="true" column="CR_RULE_MESSAGE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Coverage Rule Alert Message">
      </Level>
    </Hierarchy>
  </Dimension>
  
   <Dimension visible="true" highCardinality="false" name="Dim_Customer" caption="Customer">
    <Hierarchy visible="true" hasAll="true" primaryKey="CD_CUSTOMER_ID">
      <Table name="BI_DIM_CUSTOMER_DETAIL">
      </Table>
      <Level name="Customer" column="CD_CUSTOMER_NAME_FULL" nameColumn="CD_CUSTOMER_NAME_FULL" ordinalColumn="CD_CUSTOMER_NAME_FULL" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Customer Name">
	</Level>
    </Hierarchy>
  </Dimension>
  
  <Dimension visible="true" highCardinality="false" name="Dim_Coverage" caption="Coverage">
    <Hierarchy visible="true" hasAll="true" allMemberName="Coverage" primaryKey="CO_COVERAGE_ID">
      <Table name="BI_DIM_COVERAGE_DETAIL">
      </Table>
      <Level name="Coverage Name" visible="true" column="CO_COVERAGE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Coverage Name" description="Coverage Name">
      </Level>
	 </Hierarchy>
  </Dimension>
  
  <Dimension visible="true" highCardinality="false" name="Dim_Quote" caption="Quote">
    <Hierarchy visible="true" hasAll="true" allMemberName="Quote" primaryKey="QD_QUOTE_ID">
      <Table name="BI_FACT_QUOTE_DETAIL">
      </Table>
      <Level name="Quote Number" visible="true" column="QD_POLICYQUOTE_NUMBER" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Quote Number" description="Quote Number">
      </Level>
	 <Level name="Quote Name" visible="true" column="QD_QUOTE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Quote Name" description="Quote Name">
      </Level>
	 </Hierarchy>
  </Dimension>
  
   <Dimension visible="true" highCardinality="false" name="Dim_Partner_Category" caption="PartnerCategory">
    <Hierarchy visible="true" hasAll="true" allMemberName="PartnerCategory" primaryKey="PE_PARTNER_ID">
      <Table name="BI_DIM_PARTNER_ENTITY">
      </Table>
        <Level name="Service Partner" visible="true" column="PE_PARTNER_SUB_TYPE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Service Partner" description="Service Partner">
          <KeyExpression>
            <SQL dialect="oracle">
              <![CDATA[(case when nvl(pe_partner_sub_type,pe_partner_type) not in (
			                                                                           'Writing Company',
			                                                                           'General Ledger Account',
			                                                                           'Broker',
			                                                                           'Business Introducer',
			                                                                           'Wholesaler',
																					   'Wholesale Agent',
			                                                                           'Retail Agent',
			                                                                           'Carrier Branch Office',
			                                                                           'Aggregator', 
			                                                                           'Agent',
			                                                                           'Sub-Agent'
																					)   
						   then 'Servicing Partners'
					   else
						   'Sales & Marketing Partners'
				   end)
				  ]]>
            </SQL>
          </KeyExpression>
        </Level>
	 </Hierarchy>
  </Dimension>

  <Cube name="OPEN_SUBMISSIONS" caption="Open Submissions" visible="true" cache="true" enabled="true">
    <Table name="BI_FACT_QUOTE_DETAIL">
	<SQL dialect="generic"> 
         <![CDATA[((%OS_PARTNER_ID% is null OR %OS_PARTNER_ID% = 118 OR BI_FACT_QUOTE_DETAIL.PE_PARTNER_ID = %OS_PARTNER_ID%) AND BI_FACT_QUOTE_DETAIL.os_object_state_id NOT IN (67, 73, 85, 23005, 28905, 33305, 36646, 40446, 44446, 45046, 53540, 61146, 61548))]]>           
      </SQL>
    </Table>
    
    <DimensionUsage source="Dim_Broker" name="Broker" foreignKey="PE_PARTNER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Underwriter" name="Underwriter" foreignKey="UD_UNDERWRITER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Line_of_Business" name="Line of Business" foreignKey="PD_PRODUCT_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Dim_Customer" name="Customer" foreignKey="CD_CUSTOMER_ID" highCardinality="false">
    </DimensionUsage>
    <Dimension type="StandardDimension" visible="true" foreignKey="OS_OBJECT_STATE_ID" highCardinality="false" name="Status">
      <Hierarchy visible="true" hasAll="true">
        <Table name="BI_DIM_OBJECT_STATE">
        </Table>
        <Level name="Quote Status" visible="true" column="OS_QUOTE_STATUS" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Quote status">
        </Level>
        <Level name="Application Status" visible="true" column="OS_OBJECT_STATE_ID" nameColumn="OS_OBJECT_STATE_NAME" ordinalColumn="OS_OBJECT_STATE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Current state of quote">
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension type="StandardDimension" highCardinality="false" name="Submission_Jurisdiction" caption="Submission Jurisdiction">
      <Hierarchy hasAll="true">
        <Level name="Jurisdiction" column="QD_PROD_JURISDICTION_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Jurisdiction">
        </Level>
      </Hierarchy>
    </Dimension>
	
    <Dimension type="StandardDimension" highCardinality="false" name="Quote" caption="Quote">
      <Hierarchy hasAll="true">
        <Level name="Quote Name" column="QD_QUOTE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Quote Name">
        </Level>
	    <Level name="Quote Number" column="QD_POLICYQUOTE_NUMBER" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Quote Number">
        </Level>
      </Hierarchy>
    </Dimension>
    
    
    <Dimension type="StandardDimension" highCardinality="false" name="Submission_Age" caption="Submission Age">
      <Hierarchy hasAll="true">
	   <Level name="Submission_Age" visible="true" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never"  caption="Submission Age" description="Submission Age">
          <KeyExpression>
            <SQL dialect="oracle">
              <![CDATA[(case when ((round(sysdate - qd_create_dt, 0) < 0) or (round(sysdate - qd_create_dt, 0) between 0 and 30))
						   then '0-30 days'
					   when round(sysdate - qd_create_dt, 0) between 31 and 60
						   then '31-60 days'
					   when round(sysdate - qd_create_dt, 0) between 61 and 90
						   then '61-90 days'
					   when round(sysdate - qd_create_dt, 0) > 90
						   then 'Above 90 days'
					   else
						   'Others'
				   end)
				  ]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>
    
    <Measure name="Total_Open_Submissions" column="QD_SUBMISSION_ID" datatype="Numeric" formatString="#,###" aggregator="distinct-count" caption="Open Submissions Count" description="Total Open Submissions">
    </Measure>
    <Measure name="Total_Open_Quotes" column="QD_QUOTE_ID" datatype="Numeric" formatString="#,###" aggregator="count" caption="Open Quotes Count" description="Total Open Quotes">
    </Measure>
    <Measure name="Total_Premium" column="QD_PREMIUM_AMT" datatype="Numeric" formatString="$#,###" aggregator="sum" caption="Total Premium" description="Open Submissions Premium">
    </Measure>

  </Cube>

  <!-- Open Tasks -->
  <Cube name="OPEN_TASKS" caption="Open Tasks" visible="true" cache="true" enabled="true">
    <Table name="BI_FACT_TASK_DETAIL">
	<SQL dialect="generic">
         <![CDATA[(((%OS_PARTNER_ID% is null OR %OS_PARTNER_ID% = 118 AND BI_FACT_TASK_DETAIL.PE_PARTNER_ID = %OS_PARTNER_ID%)
		  AND ( %OS_USER_ID% is null OR BI_FACT_TASK_DETAIL.UD_ASSIGNED_USER_ID = %OS_USER_ID%
			  OR BI_FACT_TASK_DETAIL.UD_ASSIGNED_USER_ID IN (select UD_USER_ID from BI_DIM_USER_DETAIL WHERE UD_REPORTS_TO_USER = %OS_USER_ID%))
		  OR 
		  (%OS_PARTNER_ID% is null OR %OS_PARTNER_ID% != 118 AND BI_FACT_TASK_DETAIL.PE_PARTNER_ID = %OS_PARTNER_ID%))     
		  AND TD_STATUS_IND != 1)]]>        
      </SQL>
    </Table>
    <DimensionUsage source="Dim_Creator" name="Creator" visible="true" foreignKey="UD_CREATOR_ID" highCardinality="false">
    </DimensionUsage>

    <DimensionUsage source="Dim_Broker" name="Broker" foreignKey="PE_PARTNER_ID" highCardinality="false">
    </DimensionUsage>

    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Task Type" caption="Task Type">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Task Types">
        <Level name="Task Type" visible="true" column="TD_TASK_TYPE_DESC" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Task Type" description="Type of task. Useful if this is a system generated task">
        </Level>
        <Level name="Task Title" visible="true" column="TD_TASK_TITLE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Task Title" description="Title of task. Useful if this is a system generated task">
        </Level>
      </Hierarchy>
    </Dimension>
	
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Overdue" caption="Overdue?">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Complete and Incomplete">
        <Level name="Overdue" visible="true" column="TD_OVERDUE_IND" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Overdue" description="Is this Task overdue?">
          <KeyExpression>
            <SQL dialect="oracle"> 
              <![CDATA[case 
					when TD_OVERDUE_IND=1 then 'Yes'  
					when  TD_OVERDUE_IND=2 then 'No'  
					when  TD_OVERDUE_IND is null then 'No'  
					else 'No' end]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Internal Indicator" caption="Internal?">
      <Hierarchy visible="true" hasAll="true">
        <Level name="Internal" visible="true" column="TD_INTERNAL_IND" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Internal" description="Is the task being assigned internally ?">
          <KeyExpression>
            <SQL dialect="oracle">
              <![CDATA[case 
					when TD_INTERNAL_IND=1 then 'Yes'  
					when  TD_INTERNAL_IND=2 then 'No'  
					when  TD_INTERNAL_IND is null then 'No'  
					else 'No' end]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Task ID" caption="Task ID">
      <Hierarchy visible="true" hasAll="true">
        <Level name="Task ID" visible="true" column="TD_TASK_ID" type="Numeric" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Task ID" description="Task Id">
        </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension type="StandardDimension" highCardinality="false" name="Open_Task_Age" caption="Open Task Age">
      <Hierarchy hasAll="true">
	   <Level name="Open_Task_Age" visible="true" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never"  caption="Open Task Age" description="Open Task Age">
          <KeyExpression>
            <SQL dialect="oracle">
              <![CDATA[(case when ((round(sysdate - TD_CREATE_DT, 0) < 0) or (round(sysdate - TD_CREATE_DT, 0) between 0 and 30))
						   then '0-30 days'
					   when round(sysdate - TD_CREATE_DT, 0) between 31 and 60
						   then '31-60 days'
					   when round(sysdate - TD_CREATE_DT, 0) between 61 and 90
						   then '61-90 days'
					   when round(sysdate - TD_CREATE_DT, 0) > 90
						   then 'Above 90 days'
					   else
						   'Others'
				   end)
				  ]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>
	
    <Measure name="Open_Task_Count" column="TD_TASK_ID" datatype="Numeric" formatString="#,###" aggregator="count" caption="Open Task Count" description="Number of Tasks">
    </Measure>
    <Measure name="Overdue_Task_Count" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Overdue Task Count" description="Overdue Task Count">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[decode(TD_OVERDUE_IND, 1, 1, 0)]]>
        </SQL>
      </MeasureExpression>
    </Measure>
  </Cube>
  
    <!-- Closed Tasks -->
  <Cube name="CLOSED_TASKS" caption="Closed Tasks" visible="true" cache="true" enabled="true">
    <Table name="BI_FACT_TASK_DETAIL">
	<SQL dialect="generic">
         <![CDATA[(((%OS_PARTNER_ID% is null OR %OS_PARTNER_ID% = 118 AND BI_FACT_TASK_DETAIL.PE_PARTNER_ID = %OS_PARTNER_ID%)
		  AND ( %OS_USER_ID% is null OR BI_FACT_TASK_DETAIL.UD_ASSIGNED_USER_ID = %OS_USER_ID%
			  OR BI_FACT_TASK_DETAIL.UD_ASSIGNED_USER_ID IN (select UD_USER_ID from BI_DIM_USER_DETAIL WHERE UD_REPORTS_TO_USER = %OS_USER_ID%))
		  OR 
		  (%OS_PARTNER_ID% is null OR %OS_PARTNER_ID% != 118 AND BI_FACT_TASK_DETAIL.PE_PARTNER_ID = %OS_PARTNER_ID%))     
		AND TD_STATUS_IND = 1)]]>           
      </SQL>
    </Table>
    <DimensionUsage source="Dim_Creator" name="Creator" visible="true" foreignKey="UD_CREATOR_ID" highCardinality="false">
    </DimensionUsage>

    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Task Type" caption="Task Type">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Task Types">
        <Level name="Task Type" visible="true" column="TD_TASK_TYPE_DESC" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Task Type" description="Type of task. Useful if this is a system generated task">
        </Level>
        <Level name="Task Title" visible="true" column="TD_TASK_TITLE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Task Title" description="Title of task. Useful if this is a system generated task">
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Overdue" caption="Overdue?">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Complete and Incomplete">
        <Level name="Overdue" visible="true" column="TD_OVERDUE_IND" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Overdue" description="Is this Task overdue?">
          <KeyExpression>
            <SQL dialect="oracle"> 
              <![CDATA[case 
					when TD_OVERDUE_IND=1 then 'Yes'  
					when  TD_OVERDUE_IND=2 then 'No'  
					when  TD_OVERDUE_IND is null then 'No'  
					else 'No' end]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Internal Indicator" caption="Internal?">
      <Hierarchy visible="true" hasAll="true">
        <Level name="Internal" visible="true" column="TD_INTERNAL_IND" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Internal" description="Is the task being assigned internally ?">
          <KeyExpression>
            <SQL dialect="oracle">
              <![CDATA[case 
					when TD_INTERNAL_IND=1 then 'Yes'  
					when  TD_INTERNAL_IND=2 then 'No'  
					when  TD_INTERNAL_IND is null then 'No'  
					else 'No' end]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Task ID" caption="Task ID">
      <Hierarchy visible="true" hasAll="true">
        <Level name="Task ID" visible="true" column="TD_TASK_ID" type="Numeric" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Task ID" description="Task Id">
        </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension type="StandardDimension" highCardinality="false" name="Closed_TAT" caption="Closed Task Turn Around Time">
      <Hierarchy hasAll="true">
	   <Level name="Closed_TAT" visible="true" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never"  caption="Closed Task TAT" description="Closed Task Turn Around Time">
          <KeyExpression>
            <SQL dialect="oracle">
              <![CDATA[(case when ((round(TD_COMPLETED_DT - TD_CREATE_DT, 0) < 0) or (round(TD_COMPLETED_DT - TD_CREATE_DT, 0) between 0 and 30))
						   then '0-30 days'
					   when round(TD_COMPLETED_DT - TD_CREATE_DT, 0) between 31 and 60
						   then '31-60 days'
					   when round(TD_COMPLETED_DT - TD_CREATE_DT, 0) between 61 and 90
						   then '61-90 days'
					   when round(TD_COMPLETED_DT - TD_CREATE_DT, 0) > 90
						   then 'Above 90 days'
					   else
						   'Others'
				   end)
				  ]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>
	
    <Measure name="Closed_Task_Count" column="TD_TASK_ID" datatype="Numeric" formatString="#,###" aggregator="count" caption="Closed Task Count" description="Number of Tasks">
    </Measure>
    <Measure name="Overdue_Task_Count" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Overdue Task Count" description="Overdue Task Count">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[decode(TD_OVERDUE_IND, 1, 1, 0)]]>
        </SQL>
      </MeasureExpression>
    </Measure>
  </Cube>
  
  <Cube name="ALL_TASKS" caption="All Tasks" visible="true" cache="true" enabled="true">
    <Table name="BI_FACT_TASK_DETAIL">
	<SQL dialect="generic">
         <![CDATA[(((%OS_PARTNER_ID% is null OR %OS_PARTNER_ID% = 118 AND BI_FACT_TASK_DETAIL.PE_PARTNER_ID = %OS_PARTNER_ID%)
		  AND ( %OS_USER_ID% is null OR BI_FACT_TASK_DETAIL.UD_ASSIGNED_USER_ID = %OS_USER_ID%
			  OR BI_FACT_TASK_DETAIL.UD_ASSIGNED_USER_ID IN (select UD_USER_ID from BI_DIM_USER_DETAIL WHERE UD_REPORTS_TO_USER = %OS_USER_ID%))
		  OR 
		  (%OS_PARTNER_ID% is null OR %OS_PARTNER_ID% != 118 AND BI_FACT_TASK_DETAIL.PE_PARTNER_ID = %OS_PARTNER_ID%))     
		AND (TD_CREATE_DT >= add_months(trunc(sysdate), -12) OR TD_STATUS_IND != 1))]]>           
      </SQL>
    </Table>
	
    <DimensionUsage source="Dim_Creator" name="Creator" visible="true" foreignKey="UD_CREATOR_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Dim_Assignee" name="Assignee" visible="true" foreignKey="UD_ASSIGNED_USER_ID" highCardinality="false">
    </DimensionUsage>
	

    <Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="TD_TASK_ID" name="Time (Creation Date)" caption="Time (Creation Date)">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="TD_TASK_ID">
        <View alias="vw_td_create_dt">
          <SQL dialect="generic">    
		   SELECT
			 td_task_id,
			 EXTRACT(YEAR FROM td_create_dt)       td_year,
			 to_number(to_char(td_create_dt, 'Q')) td_quarter,
			 'Q' || to_char(td_create_dt, 'Q')     td_quarter_name,
			 EXTRACT(MONTH FROM td_create_dt)      td_month,
			 to_char(td_create_dt, 'Mon')          td_month_name,
			 to_char(TD_CREATE_DT,'WW')            td_week,			   
			 EXTRACT(DAY FROM td_create_dt)        td_day,
			 td_create_dt					    td_date
		  FROM
			 bi_fact_task_detail
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Creation Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Creation Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Creation Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Creation Week" description="Creation Week">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Date" description="Creation Date">
      </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="TD_TASK_ID" name="Time (Completed Date)" caption="Time (Completed Date)">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="TD_TASK_ID">
        <View alias="vw_td_completed_dt">
          <SQL dialect="generic">    
		   SELECT
			 td_task_id,
			 EXTRACT(YEAR FROM td_completed_dt)       td_year,
			 to_number(to_char(td_completed_dt, 'Q')) td_quarter,
			 'Q' || to_char(td_completed_dt, 'Q')     td_quarter_name,
			 EXTRACT(MONTH FROM td_completed_dt)      td_month,
			 to_char(td_completed_dt, 'Mon')          td_month_name,
			 to_char(TD_COMPLETED_DT,'WW')         td_week,			   
			 EXTRACT(DAY FROM td_completed_dt)        td_day,
			 td_completed_dt					      td_date
		  FROM
			 bi_fact_task_detail
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Completed Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Completed Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Completed Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Completed Week" description="Completed Week">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Completed Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Completed Date" description="Completed Date">
      </Level>
      </Hierarchy>
    </Dimension>
    
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Task Type" caption="Task Type">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Task Types">
        <Level name="Task Type" visible="true" column="TD_TASK_TYPE_DESC" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Task Type" description="Type of task. Useful if this is a system generated task">
        </Level>
        <Level name="Task Title" visible="true" column="TD_TASK_TITLE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Task Title" description="Title of task. Useful if this is a system generated task">
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Overdue" caption="Overdue?">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Complete and Incomplete">
        <Level name="Overdue" visible="true" column="TD_OVERDUE_IND" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Overdue" description="Is this Task overdue?">
          <KeyExpression>
            <SQL dialect="oracle">
              <![CDATA[case 
					when TD_OVERDUE_IND=1 then 'Yes'  
					when  TD_OVERDUE_IND=2 then 'No'  
					when  TD_OVERDUE_IND is null then 'No'  
					else 'No' end]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Internal Indicator" caption="Internal?">
      <Hierarchy visible="true" hasAll="true">
        <Level name="Internal" visible="true" column="TD_INTERNAL_IND" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Internal" description="Is the task being assigned internally ?">
          <KeyExpression>
            <SQL dialect="oracle">
              <![CDATA[case 
					when TD_INTERNAL_IND=1 then 'Yes'  
					when  TD_INTERNAL_IND=2 then 'No'  
					when  TD_INTERNAL_IND is null then 'No'  
					else 'No' end]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Task Status" caption="Task Status">
      <Hierarchy visible="true" hasAll="true">
        <Level name="Task Status" visible="true" column="TD_STATUS_IND" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Task Status" description="Status of the Task">
          <KeyExpression>
            <SQL dialect="oracle">
              <![CDATA[case 
					when TD_STATUS_IND=1 then 'Complete'  
					else 'Incomplete' end]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Task Rejection Reason" caption="Task Rejection Reason">
      <Hierarchy visible="true" hasAll="true">
        <Level name="Task Rejection Reason" visible="true" column="TD_POLICY_REJECTION_REASON" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Task Rejection reason" description="Rejection Reason for the Task">
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Task ID" caption="Task ID">
      <Hierarchy visible="true" hasAll="true">
        <Level name="Task ID" visible="true" column="TD_TASK_ID" type="Numeric" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Task ID" description="Task Id">
        </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension type="StandardDimension" highCardinality="false" name="Task_Age" caption="Task Age">
      <Hierarchy hasAll="true">
	   <Level name="Task_Age" visible="true" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never"  caption="Task Age" description="Task Age">
          <KeyExpression>
            <SQL dialect="oracle">
              <![CDATA[(case when (round(sysdate - TD_CREATE_DT, 0) < 0) or (round(sysdate - TD_CREATE_DT, 0) between 0 and 30)
               then '0-30 days'
             when (round(sysdate - TD_CREATE_DT, 0) between 31 and 60)
               then '31-60 days'
             when (round(sysdate - TD_CREATE_DT, 0) between 61 and 90)
               then '61-90 days'
             when (round(sysdate - TD_CREATE_DT, 0) > 90)
               then 'Above 90 days'
             else
               'Others'
           end)]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension type="StandardDimension" highCardinality="false" name="Task_TAT" caption="Task Turn Around Time">
      <Hierarchy hasAll="true">
	   <Level name="Task_TAT" visible="true" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never"  caption="Task Turn Around Time" description="Task Turn Around Time">
          <KeyExpression>
            <SQL dialect="oracle">
              <![CDATA[(case when ((round(TD_COMPLETED_DT - TD_CREATE_DT, 0) < 0) or (round(TD_COMPLETED_DT - TD_CREATE_DT, 0) between 0 and 30))
						   then '0-30 days'
					   when round(TD_COMPLETED_DT - TD_CREATE_DT, 0) between 31 and 60
						   then '31-60 days'
					   when round(TD_COMPLETED_DT - TD_CREATE_DT, 0) between 61 and 90
						   then '61-90 days'
					   when round(TD_COMPLETED_DT - TD_CREATE_DT, 0) > 90
						   then 'Above 90 days'
					   else
						   'Others'
				   end)
				  ]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>
	
    <Measure name="Total_Task_Count" column="TD_TASK_ID" datatype="Numeric" formatString="#,###" aggregator="count" caption="Total Task Count" description="Number of Tasks">
    </Measure>
    <Measure name="Open_Task_Count" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Open Task Count(Non-Overdue)" description="Number of Incomplete Tasks">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[decode(TD_STATUS_IND, 2, 1, 0)]]>
        </SQL>
      </MeasureExpression>
    </Measure>
    <Measure name="Completed_Task_Count" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Completed Task Count" description="Total of Completed Tasks">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[decode(TD_STATUS_IND, 1, 1, 0)]]>
        </SQL>
      </MeasureExpression>
    </Measure>
	<Measure name="Open_Overdue_Task_Count" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Open Task Count(Overdue)" description="Number of Incomplete Tasks">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[decode(TD_STATUS_IND, 42346, 1, 0)]]>
        </SQL>
      </MeasureExpression>
    </Measure>
    <Measure name="Overdue_Task_Count" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Overdue Task Count" description="Overdue Task Count">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[decode(TD_OVERDUE_IND, 1, 1, 0)]]>
        </SQL>
      </MeasureExpression>
    </Measure>
    <Measure name="On_Time_Task_Count" datatype="Numeric" formatString="#,###" aggregator="sum" caption="On Time Task Count" description="Tasks Done on or before the due date">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[case when TD_STATUS_IND = 1 and TD_COMPLETED_DT < TD_DUE_DT and TD_COMPLETED_DT != '01-JAN-1900' then 1 else 0 end]]>
        </SQL>
      </MeasureExpression>
    </Measure>
    <Measure name="Total_Completion_Time" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Days to Complete Task" description="Total number of days to complete task">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[(case when TD_TIME_TO_COMPLETE_DAYS is null THEN 0 ELSE TD_TIME_TO_COMPLETE_DAYS END)]]>
        </SQL>
      </MeasureExpression>
    </Measure>
	<Measure name="Avg_TAT_Time" datatype="Numeric" formatString="#,###.00" aggregator="avg" caption="Average Task Turn Around Time" description="Average Task Turn Around Time">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[ case when TD_STATUS_IND = 1 THEN(round(TD_COMPLETED_DT - TD_CREATE_DT, 0)) ELSE null END]]>
        </SQL>
      </MeasureExpression>
    </Measure>
	
	<Measure name="Total_Open_Task_Count" datatype="Numeric" formatString="#,###" aggregator="count" caption="Open Task Count" description="Number of Incomplete Tasks">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[case when TD_STATUS_IND != 1 then TD_TASK_ID else null end]]>
        </SQL>
      </MeasureExpression>
    </Measure>
    
    <CalculatedMember name="Avg_Completion_Time" formatString="###.000" caption="Avg Time to Complete" description="Average time taken to complete (in business days)" dimension="Measures">
      <Formula>
        <![CDATA[IIf( [Measures].[Total_Task_Count] = 0, null, [Measures].[Total_Completion_Time] / [Measures].[Total_Task_Count] )]]>
      </Formula>
    </CalculatedMember>
    <CalculatedMember name="Percent_Completed_Tasks" formatString="###.0%" caption="% Complete" description="Completed Tasks Percent" dimension="Measures">
      <Formula>
        <![CDATA[IIf( ([Measures].[Task_Count] = 0 or [Measures].[Completed_Task_Count] = 0), null, [Measures].[Completed_Task_Count] / [Measures].[Task_Count])]]>
      </Formula>
    </CalculatedMember>
    <CalculatedMember name="Percent_Incomplete_Tasks" formatString="###.0%" caption="% Incomplete" description="Incomplete Tasks Percent" dimension="Measures">
      <Formula>
        <![CDATA[IIf( ([Measures].[Task_Count] = 0 or [Measures].[Open_Task_Count] = 0), null, [Measures].[Open_Task_Count] / [Measures].[Task_Count])]]>
      </Formula>
    </CalculatedMember>
    <CalculatedMember name="Percent_Overdue_Tasks" formatString="###.0%" caption="Overdue task %" description="Overdue Tasks Percent" dimension="Measures">
      <Formula>
        <![CDATA[IIf( ([Measures].[Open_Task_Count] = 0 or [Measures].[Overdue_Task_Count] = 0), null, [Measures].[Overdue_Task_Count] / [Measures].[Open_Task_Count])]]>
      </Formula>
    </CalculatedMember>

  </Cube>
  
  <Cube name="UW_REFERRAL_SUMMARY" caption="Underwriting Referral Summary" visible="true" cache="true" enabled="true">
	<View alias="vw_referral_summary">
     <SQL dialect="generic">  
			select URT.URT_ID,
				   URT.URT_PTP_ID,
				   URT.URT_PT_ID,
				   URT.PD_PRODUCT_ID,
				   URT.CD_CUSTOMER_ID,
				   URT.UD_UNDERWRITER_ID,
				   URT.AD_RISK_ADDRESS_ID,
				   URT.OS_OBJECT_STATE_ID,
				   URT.PP_PRODUCER_ID,
				   URT.PE_BROKER_ID,
				   URT.PE_PARTNER_ID,
				   URT.USER_SESSION_ID,
				   URT.TRANSACTION_ID,
				   URT.DRAGON_OBJECT_ID,
				   URT.URT_START_DATE,
				   URT.URT_END_DATE,
				   URT.URT_TRANSACTION_TYPE,
				   URT.URT_REFERRAL_COUNT,
				   URT.URT_REFERRAL_ACCEPT_IND,
				   URT.URT_REFERRAL_REJECT_IND,
				   URT.URT_REFERRAL_PEER_IND,
				   URT.URT_RESOLUTION_TIME,
				   URT.URT_IN_REFERRAL_IND,
				   URT.URT_UW_REF_PEER_REFERRED_NBR,
				   URT.URT_TRACKER_OUTCOME,
				   URT.PE_WRITING_COMPANY_ID,
				   URT.PE_CARRIER_BRANCH_ID,
				   URT.URT_LAST_UPDATED_DATE,
                  /* URT.URT_TRANSACTION_STATUS, this column was dropped from higher environment in OSPRODUCT-18846*/
				   QURT.QD_QUOTE_NAME,
				   QURT.QD_POLICYQUOTE_NUMBER,
				   PURT.POD_POLICY_NUMBER,
				   PURT.POD_BILLING_METHOD
			  from BI_FACT_UW_REFERRAL_TRACKER URT
			  LEFT JOIN (select p.qd_quote_name, p.qd_policyquote_number, d.urt_id
						   from BI_FACT_UW_REFERRAL_TRACKER d, bi_fact_quote_detail p
						  where d.urt_ptp_id = p.qd_quote_id) QURT
				ON (QURT.URT_ID = URT.URT_ID)
			  LEFT JOIN (select d1.urt_id, pod.pod_policy_number, pod.POD_BILLING_METHOD
						   from BI_FACT_UW_REFERRAL_TRACKER d1,
								bi_fact_policy_trx_detail   pt,
								bi_dim_policy_detail        pod
						  where pt.pt_policy_id = pod.pod_policy_id
							and pt.pt_id = d1.urt_pt_id) PURT
				ON (PURT.URT_ID = URT.URT_ID)
			WHERE (%OS_PARTNER_ID% is null OR %OS_PARTNER_ID% = 118 OR PE_PARTNER_ID = %OS_PARTNER_ID%)
	 </SQL>
    </View>

	<DimensionUsage source="UW Policy Term" name="UW Policy Term" caption="UW Policy Term" visible="true" foreignKey="URT_PT_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Address" name="Address" caption="Address" visible="true" foreignKey="AD_RISK_ADDRESS_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Line_of_Business" name="Line of Business" visible="true" foreignKey="PD_PRODUCT_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Producer" name="Producer" visible="true" foreignKey="PP_PRODUCER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Underwriter" name="Underwriter" visible="true" foreignKey="UD_UNDERWRITER_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Carrier Branch" name="Carrier Branch" visible="true" foreignKey="PE_CARRIER_BRANCH_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Writing Company" name="Writing Company" visible="true" foreignKey="PE_WRITING_COMPANY_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Policy Details" name="Policy Details" visible="true" foreignKey="URT_PT_ID" highCardinality="false">
    </DimensionUsage>
	<!--<DimensionUsage source="Dim_Quote" name="Quote" visible="true" foreignKey="URT_PTP_ID" highCardinality="false">
    </DimensionUsage> 
    <DimensionUsage source="UW Policy" name="UW Policy" caption="UW Policy" visible="true" foreignKey="URT_PT_ID" highCardinality="false">
    </DimensionUsage> -->
	
    <Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="URT_ID" name="Time (Creation Date)" caption="Time (Creation Date)">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="URT_ID">
        <View alias="vw_urt_start_date">
          <SQL dialect="generic">    
		   SELECT
			 urt_id,
			 EXTRACT(YEAR FROM urt_start_date)       td_year,
			 to_number(to_char(urt_start_date, 'Q')) td_quarter,
			 'Q' || to_char(urt_start_date, 'Q')     td_quarter_name,
			 EXTRACT(MONTH FROM urt_start_date)      td_month,
			 to_char(urt_start_date, 'Mon')          td_month_name,
			 to_char(urt_start_date,'WW')            td_week,
			 EXTRACT(DAY FROM urt_start_date)        td_day,
			 urt_start_date					 td_date
		  FROM
			 bi_fact_uw_referral_tracker
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Creation Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Creation Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Creation Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Creation Week" description="Creation Week">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Date" description="Creation Date">
      </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="URT_ID" name="Time (Completed Date)" caption="Time (Completed Date)">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="URT_ID">
        <View alias="vw_urt_end_date">
          <SQL dialect="generic">    
		   SELECT
			 urt_id,
			 EXTRACT(YEAR FROM urt_end_date)       td_year,
			 to_number(to_char(urt_end_date, 'Q')) td_quarter,
			 'Q' || to_char(urt_end_date, 'Q')     td_quarter_name,
			 EXTRACT(MONTH FROM urt_end_date)      td_month,
			 to_char(urt_end_date, 'Mon')          td_month_name,
			 to_char(urt_end_date,'WW')            td_week,
			 EXTRACT(DAY FROM urt_end_date)        td_day,
			 urt_end_date					    td_date
		  FROM
			 bi_fact_uw_referral_tracker
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Completed Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Completed Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Completed Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Completed Week" description="Completed Week">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Completed Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Completed Date" description="Completed Date">
      </Level>
      </Hierarchy>
    </Dimension>
	<Dimension visible="true" highCardinality="false" name="Last Updated Date" caption="Last Updated Date">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Last Updated Dates">
        <Level name="Last Updated Date" visible="true" column="URT_LAST_UPDATED_DATE" type="Date" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Last Updated Date">
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="UW_Referral_Outcome" caption="Disposition" description="The outcome of an underwring referral">
      <Hierarchy visible="true" hasAll="true">
        <Level name="UW_Referral_Outcome" visible="true" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Disposition" description="The outcome of an underwring referral">
          <KeyExpression>
            <SQL dialect="oracle">
              <![CDATA[CASE WHEN URT_TRACKER_OUTCOME=36601 THEN 'Accepted'
		                  WHEN URT_TRACKER_OUTCOME=36701 THEN 'Rejected'
					   WHEN URT_TRACKER_OUTCOME=36501 THEN 'In Progress'
					   WHEN URT_TRACKER_OUTCOME=36801 THEN 'In Progress' 
					   ELSE 'Unknown' END]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Policy Transaction" caption="Policy Transaction">
      <Hierarchy visible="true" hasAll="true">
        <Level name="Policy Transaction" visible="true" column="URT_TRANSACTION_TYPE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Type of Policy Transaction">
        </Level>
      </Hierarchy>
    </Dimension>

   <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Quote" caption="Quote">
      <Hierarchy visible="true" hasAll="true">
      <Level name="Quote Number" visible="true" type="String" column="QD_POLICYQUOTE_NUMBER" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Quote Number">
      </Level>
	  <Level name="Quote Name" visible="true" type="String"  column="QD_QUOTE_NAME" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Quote Name">
      </Level>
      </Hierarchy>
    </Dimension>	
	
   <Dimension  type="StandardDimension" visible="true" highCardinality="false" name="UW Policy" caption="UW Policy">
      <Hierarchy visible="true" hasAll="true">
      <Level name="Policy Billing Method" visible="true" column="POD_BILLING_METHOD" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Policy Billing Method">  
      </Level>
	  <Level name="Policy Number" visible="true" column="POD_POLICY_NUMBER" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Policy Number">  
      </Level>
    </Hierarchy>
   </Dimension> 
	
    <Measure name="Total_Referral_Count" column="URT_ID" datatype="Numeric" formatString="#,###" aggregator="count" caption="Total Referred Count" description="Total number of Underwriting Alerts">
    </Measure>
    <Measure name="UW_Peer_Referred_Count" column="URT_UW_REF_PEER_REFERRED_NBR" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Underwriting - Peer Referred Count" description="Number of times this referral was peer referred.">
    </Measure>
    <Measure name="Total_Transaction_Count" column="URT_PT_ID" datatype="Numeric" formatString="#,###" aggregator="count" caption="Total Transaction Count" description="Total number of Transactions with referrals">
    </Measure>
    <Measure name="Total_Open_Referral_Count" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Open Referred Count" description="Number of referrals Open" visible="true">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[(case when urt_tracker_outcome in (36501, 36801) then 1 else 0 end)]]>
        </SQL>
      </MeasureExpression>
    </Measure>
    <Measure name="Resolution_Time" column="URT_RESOLUTION_TIME" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Total Resolution Time" description="Resolution Time in Days">
    </Measure>
    <Measure name="Avg_Resolution_Time" column="URT_RESOLUTION_TIME" datatype="Numeric" formatString="#,###.00" aggregator="avg" caption="Avg Resolution Time" description="Average Resolution Time taken in Days">
    </Measure>
    <Measure name="Rejected_Count" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Referral Rejected" description="Number of referrals rejected" visible="true">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[decode(URT_REFERRAL_REJECT_IND, 1, 1, 0)]]>
        </SQL>
      </MeasureExpression>
    </Measure>
    <Measure name="Accepted_Count" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Referral Accepted" description="Number of referrals accepted" visible="true">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[decode(URT_REFERRAL_ACCEPT_IND, 1, 1, 0)]]>
        </SQL>
      </MeasureExpression>
    </Measure>
    <Measure name="Referred_to_Peer_Count" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Referred to Peer Count" description="Number of referrals referred to Peer" visible="true">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[decode(URT_REFERRAL_PEER_IND, 1, 1, 0)]]>
        </SQL>
      </MeasureExpression>
    </Measure>
    <CalculatedMember name="Accepted_Referrals_Ratio" formatString="###.00%" caption="Accept Ratio %" description="Accept Ratio of Referrals" dimension="Measures">
      <Formula>
        <![CDATA[IIf( [Measures].[Accepted_Count] = 0, null,  ( [Measures].[Accepted_Count]/[Measures].[Total_Referral_Count] ))]]>
      </Formula>
    </CalculatedMember>
    <CalculatedMember name="Rejected_Referrals_Ratio" formatString="###.00%" caption="Reject Ratio %" description="Reject Ratio of Referrals" dimension="Measures">
      <Formula>
        <![CDATA[IIf( [Measures].[Rejected_Count] = 0, null,  ( [Measures].[Rejected_Count]/[Measures].[Total_Referral_Count] ))]]>
      </Formula>
    </CalculatedMember>
    <CalculatedMember name="Avg_No_of_Referrals" formatString="#,###.00" caption="Avg No of Referrals per Transaction" description="Average No of Referrals per Transaction" dimension="Measures">
      <Formula>
        <![CDATA[IIf( [Measures].[Total_Referral_Count] = 0, null, [Measures].[Total_Referral_Count] / [Measures].[Total_Transaction_Count] )]]>
      </Formula>
    </CalculatedMember>
  </Cube>
  
  <Cube name="UW_REFERRAL_DETAIL" caption="Underwriting Referral Detail" visible="true" cache="true" enabled="true">
	<View alias="vw_referral_detail">
     <SQL dialect="generic">  
		select URD.*,
			   QURD.QD_QUOTE_NAME,
			   QURD.QD_POLICYQUOTE_NUMBER,
			   PURD.POD_POLICY_NUMBER,
			   PURD.POD_BILLING_METHOD
		  from BI_FACT_UW_REFERRAL_DETAIL URD
		  LEFT JOIN (select p.qd_quote_name, p.qd_policyquote_number, d.URD_ID
					   from BI_FACT_UW_REFERRAL_DETAIL d, bi_fact_quote_detail p
					  where d.urd_ptp_id = p.qd_quote_id) QURD
			ON (QURD.URD_ID = URD.URD_ID)
		  LEFT JOIN (select d1.URD_ID, pod.pod_policy_number, pod.POD_BILLING_METHOD
					   from BI_FACT_UW_REFERRAL_DETAIL d1,
							bi_fact_policy_trx_detail   pt,
							bi_dim_policy_detail        pod
					  where pt.pt_policy_id = pod.pod_policy_id
						and pt.pt_id = d1.urd_pt_id) PURD
			ON (PURD.URD_ID = URD.URD_ID)
		  WHERE (%OS_PARTNER_ID% is null OR %OS_PARTNER_ID% = 118 OR PE_PARTNER_ID = %OS_PARTNER_ID%) 
	 </SQL>
	 </View>

	<DimensionUsage source="UW Policy Term" name="UW Policy Term" caption="UW Policy Term" visible="true" foreignKey="URD_PT_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Policy Details" name="Policy Details" caption="Policy Details" visible="true" foreignKey="URD_PT_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Address" name="Address" caption="Address" visible="true" foreignKey="AD_RISK_ADDRESS_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Line_of_Business" name="Line of Business" visible="true" foreignKey="PD_PRODUCT_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Producer" name="Producer" visible="true" foreignKey="PP_PRODUCER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Underwriter" name="Underwriter" visible="true" foreignKey="UD_UNDERWRITER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Corrected By Agency" name="Corrected By Agency" visible="true" foreignKey="URD_CORRECTED_BROKER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Corrected By Underwriter" name="Corrected By Underwriter" visible="true" foreignKey="URD_CORRECTED_BY" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Underwriting Rule" name="Underwriting Rule" visible="true" foreignKey="PC_COVERAGE_RULE_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Carrier Branch" name="Carrier Branch" visible="true" foreignKey="PE_CARRIER_BRANCH_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Writing Company" name="Writing Company" visible="true" foreignKey="PE_WRITING_COMPANY_ID" highCardinality="false">
    </DimensionUsage>
	<!--<DimensionUsage source="Dim_Quote" name="Quote" visible="true" foreignKey="URD_PTP_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="UW Policy" name="UW Policy" caption="UW Policy" visible="true" foreignKey="URD_PT_ID" highCardinality="false">
    </DimensionUsage> -->
	
    <Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="URD_ID" name="Time (Creation Date)" caption="Time (Creation Date)">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="URD_ID">
        <View alias="vw_urd_trigger_create_dt">
          <SQL dialect="generic">    
		   SELECT
			 urd_id,
			 EXTRACT(YEAR FROM urd_trigger_create_dt)       td_year,
			 to_number(to_char(urd_trigger_create_dt, 'Q')) td_quarter,
			 'Q' || to_char(urd_trigger_create_dt, 'Q')     td_quarter_name,
			 EXTRACT(MONTH FROM urd_trigger_create_dt)      td_month,
			 to_char(urd_trigger_create_dt, 'Mon')          td_month_name,
			 to_char(urd_trigger_create_dt,'WW')            td_week,
			 EXTRACT(DAY FROM urd_trigger_create_dt)        td_day,
			 urd_trigger_create_dt					 td_date
		  FROM
			 bi_fact_uw_referral_detail
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Creation Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Creation Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Creation Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Creation Week" description="Creation Week">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Date" description="Creation Date">
      </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="URD_ID" name="Time (Completed Date)" caption="Time (Completed Date)">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="URD_ID">
        <View alias="vw_urd_trigger_closed_dt">
          <SQL dialect="generic">    
		   SELECT
			 urd_id,
			 EXTRACT(YEAR FROM urd_trigger_closed_dt)       td_year,
			 to_number(to_char(urd_trigger_closed_dt, 'Q')) td_quarter,
			 'Q' || to_char(urd_trigger_closed_dt, 'Q')     td_quarter_name,
			 EXTRACT(MONTH FROM urd_trigger_closed_dt)      td_month,
			 to_char(urd_trigger_closed_dt, 'Mon')          td_month_name,
			 to_char(urd_trigger_closed_dt,'WW')            td_week,
			 EXTRACT(DAY FROM urd_trigger_closed_dt)        td_day,
			 urd_trigger_closed_dt					   td_date
		  FROM
			 bi_fact_uw_referral_detail
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Completed Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Completed Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Completed Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Completed Week" description="Completed Week">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Completed Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Completed Date" description="Completed Date">
      </Level>
      </Hierarchy>
    </Dimension>
	<Dimension visible="true" highCardinality="false" name="Last Updated Date" caption="Last Updated Date">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Last Updated Dates">
        <Level name="Last Updated Date" visible="true" column="URD_LAST_UPDATED_DT" type="Date" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Last Updated Date">
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="URD_ID" name="Time (Corrected On Date)" caption="Time (Corrected On Date)">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="URD_ID">
        <View alias="vw_urd_trigger_create_dt">
          <SQL dialect="generic">    
		   SELECT
			 urd_id,
			 EXTRACT(YEAR FROM urd_corrected_on)       td_year,
			 to_number(to_char(urd_corrected_on, 'Q')) td_quarter,
			 'Q' || to_char(urd_corrected_on, 'Q')     td_quarter_name,
			 EXTRACT(MONTH FROM urd_corrected_on)      td_month,
			 to_char(urd_corrected_on, 'Mon')          td_month_name,
			 to_char(urd_corrected_on,'WW')            td_week,
			 EXTRACT(DAY FROM urd_corrected_on)        td_day,
			 urd_corrected_on					   td_date
		  FROM
			 bi_fact_uw_referral_detail
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Corrected On Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Corrected On Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Corrected On Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Corrected On Week" description="Week of the Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Corrected On Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Corrected On Date" description="Corrected On Date">
      </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Triggered By Transaction" caption="Triggered By Transaction">
      <Hierarchy visible="true" hasAll="true">
        <Level name="Triggered By Transaction" visible="true" column="URD_TRANSACTION_TYPE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="The Policy Transaction this alert was triggered by">
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Alert_Override_Indicator" caption="UW Alert Override Indicator">
      <Hierarchy visible="true" hasAll="true">
        <Level name="Alert_Override_Indicator" visible="true" column="URD_TRIGGER_STATUS" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="UW Alert Override Indicator" description="Is this Alert Overridden or not">
          <KeyExpression>
            <SQL dialect="oracle">
              <![CDATA[CASE WHEN URD_TRIGGER_STATUS=1 THEN 'Yes'  
						ELSE 'No'  END]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="UW_Trigger_Forgiven_Once_Indicator" caption="UW Trigger Forgiven Once Indicator">
      <Hierarchy visible="true" hasAll="true">
        <Level name="UW_Trigger_Forgiven_Once_Indicator" visible="true" column="URD_TRIGGER_FORGIVEN_ONCE_IND" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="UW Trigger Forgiven Once Indicator" description="Is this UW Forgiven once or not">
          <KeyExpression>
            <SQL dialect="oracle">
              <![CDATA[CASE WHEN URD_TRIGGER_STATUS=1 THEN 'Yes'  
						ELSE 'No' END]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="UW_Trigger_Override_Actor_Set" caption="Override Actor Set">
      <Hierarchy visible="true" hasAll="true">
        <Level name="UW_Trigger_Override_Actor_Set" visible="true" column="URD_OVERRIDE_ACTOR_TYPE_SET" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Override Actor Type Set" description="Actor Type which has overridden the Underwriting Alert Trigger">
        </Level>
      </Hierarchy>
    </Dimension>
	
	   <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Quote" caption="Quote">
      <Hierarchy visible="true" hasAll="true">
      <Level name="Quote Number" visible="true" type="String" column="QD_POLICYQUOTE_NUMBER" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Quote Number">
      </Level>
	  <Level name="Quote Name" visible="true" type="String"  column="QD_QUOTE_NAME" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Quote Name">
      </Level>
      </Hierarchy>
    </Dimension>	
	
   <Dimension  type="StandardDimension" visible="true" highCardinality="false" name="UW Policy" caption="UW Policy">
      <Hierarchy visible="true" hasAll="true">
      <Level name="Policy Billing Method" visible="true" column="POD_BILLING_METHOD" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Policy Billing Method">  
      </Level>
	  <Level name="Policy Number" visible="true" column="POD_POLICY_NUMBER" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Policy Number">  
      </Level>
    </Hierarchy>
   </Dimension> 
   
    <Measure name="Total_Alert_Count" column="URD_ID" datatype="Numeric" formatString="#,###" aggregator="count" caption="UW Alert Rule Count">
    </Measure>
  </Cube>
  
   <Cube name="SUBMISSIONS_SUMMARY" caption="Submissions Summary" visible="true" cache="true" enabled="true">
    <Table name="BI_FACT_QUOTE_DETAIL">
	<SQL dialect="generic"> 
         <![CDATA[(%OS_PARTNER_ID% is null OR %OS_PARTNER_ID% = 118 OR BI_FACT_QUOTE_DETAIL.PE_PARTNER_ID = %OS_PARTNER_ID%)]]>           
      </SQL>
    </Table>
    
    <DimensionUsage source="Dim_Broker" name="Broker" foreignKey="PE_PARTNER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Underwriter" name="Underwriter" foreignKey="UD_UNDERWRITER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Line_of_Business" name="Line of Business" foreignKey="PD_PRODUCT_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Dim_Customer" name="Customer" foreignKey="CD_CUSTOMER_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Dim_Producer" name="Producer" visible="true" foreignKey="PP_PRODUCER_ID" highCardinality="false">
    </DimensionUsage>
	
    <Dimension type="StandardDimension" visible="true" foreignKey="OS_OBJECT_STATE_ID" highCardinality="false" name="Status">
      <Hierarchy visible="true" hasAll="true">
        <Table name="BI_DIM_OBJECT_STATE">
        </Table>
        <Level name="Quote Status" visible="true" column="OS_QUOTE_STATUS" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Quote status">
        </Level>
        <Level name="Application Status" visible="true" column="OS_OBJECT_STATE_ID" nameColumn="OS_OBJECT_STATE_NAME" ordinalColumn="OS_OBJECT_STATE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Current state of quote">
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension type="StandardDimension" highCardinality="false" name="Submission_Jurisdiction" caption="Submission Jurisdiction">
      <Hierarchy hasAll="true">
        <Level name="Jurisdiction" column="QD_PROD_JURISDICTION_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Jurisdiction">
        </Level>
      </Hierarchy>
    </Dimension>
	
    <Dimension type="StandardDimension" highCardinality="false" name="Quote" caption="Quote">
      <Hierarchy hasAll="true">
        <Level name="Quote Name" column="QD_QUOTE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Quote Name">
        </Level>
	    <Level name="Quote Number" column="QD_POLICYQUOTE_NUMBER" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Quote Number">
        </Level>
      </Hierarchy>
    </Dimension>
    
    <Dimension type="StandardDimension" highCardinality="false" name="Submission_Age" caption="Submission Age">
      <Hierarchy hasAll="true">
	   <Level name="Submission_Age" visible="true" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never"  caption="Submission Age" description="Submission Age">
          <KeyExpression>
            <SQL dialect="oracle">
              <![CDATA[(case when ((round(sysdate - qd_create_dt, 0) < 0) or (round(sysdate - qd_create_dt, 0) between 0 and 30))
						   then '0-30 days'
					   when round(sysdate - qd_create_dt, 0) between 31 and 60
						   then '31-60 days'
					   when round(sysdate - qd_create_dt, 0) between 61 and 90
						   then '61-90 days'
					   when round(sysdate - qd_create_dt, 0) > 90
						   then 'Above 90 days'
					   else
						   'Others'
				   end)
				  ]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>
    
	<Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="QD_QUOTE_ID" name="Creation Date" caption="Creation Date">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="QD_QUOTE_ID">
        <View alias="vw_quote_create_dt">
          <SQL dialect="generic">    
			   SELECT
			   QD_QUOTE_ID,
			   EXTRACT(YEAR FROM QD_CREATE_DT)       td_year,
			   to_number(to_char(QD_CREATE_DT, 'Q')) td_quarter,
			   'Q' || to_char(QD_CREATE_DT, 'Q')     td_quarter_name,
			   EXTRACT(MONTH FROM QD_CREATE_DT)      td_month,
			   to_char(QD_CREATE_DT, 'Mon')          td_month_name,
			   to_char(QD_CREATE_DT,'WW')            td_week,
			   EXTRACT(DAY FROM QD_CREATE_DT)        td_day,
			   QD_CREATE_DT                          td_date
			  FROM
			   BI_FACT_QUOTE_DETAIL Q
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Creation Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Creation Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Creation Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Creation Week" description="Week of the Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Date" description="Corrected On Date">
      </Level>
      </Hierarchy>
    </Dimension>
	
    <Measure name="Total_Submissions" column="QD_SUBMISSION_ID" datatype="Numeric" formatString="#,###" aggregator="distinct-count" caption="Total Submissions Count" description="Total Submissions">
    </Measure>
    <Measure name="Total_Quotes" column="QD_QUOTE_ID" datatype="Numeric" formatString="#,###" aggregator="count" caption="Quotes Count" description="Total Quotes">
    </Measure>
    <Measure name="Bind_Count" column="QD_BOUND_IND" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Bind Quote Count" description="Number of quotes bound">
    </Measure>
    <Measure name="Copied_Count" column="QD_COPIED_IND" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Copied Quote Count" description="Number of quotes copied">
    </Measure>
    <Measure name="Rated_Count" column="QD_RATED_IND" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Rated Quote Count" description="Number of quotes rated at least once" visible="true">
    </Measure>
    <Measure name="Rejected_Count" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Rejected Quote Count" description="Number of quotes rejected" visible="true">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[decode(BI_FACT_QUOTE_DETAIL.OS_OBJECT_STATE_ID, 23005, 1, 0)]]>
        </SQL>
      </MeasureExpression>
    </Measure>

    <Measure name="Lapsed_Count" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Lapsed Quote Count" description="Number of quotes lapsed" visible="true">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[decode(BI_FACT_QUOTE_DETAIL.OS_OBJECT_STATE_ID, 40446, 1, 0)]]>
        </SQL>
      </MeasureExpression>
    </Measure>
    <Measure name="Declined_Count" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Declined Count" description="Number of quotes declined" visible="true">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[decode(BI_FACT_QUOTE_DETAIL.OS_OBJECT_STATE_ID, 85, 1, 0)]]>
        </SQL>
      </MeasureExpression>
    </Measure>
    <Measure name="Total_Submitted_Premium" column="QD_PREMIUM_AMT" datatype="Numeric" formatString="$#,###" aggregator="sum" caption="Total Submitted Premium" description="Total Submissions Premium">
    </Measure>
    
    <Measure name="Avg_Time_to_Bind" column="QD_TIME_TO_BIND_DAYS" datatype="Numeric" formatString="####.0" aggregator="avg" caption="Avg Time to Issue (days)" description="Average time to bind a quote">
    </Measure>

    <CalculatedMember name="Bind_Rate" formatString="###.00%" caption="Conversion Ratio%" formula="IIf( [Measures].[Bind_Count] = 0, null, ([Measures].[Bind_Count] / [Measures].[Total_Quotes]) )" dimension="Measures">
    </CalculatedMember>
    
  </Cube>
  
  <Cube name="POLICY_SUMMARY" caption="Policy Summary" visible="true" cache="true" enabled="true">
    <View alias="vw_policy_summary"> 
	<SQL dialect="generic"> 
			SELECT PT_POLICY_ID,
				   PT_ID,
				   PE_PARTNER_ID,
				   UD_UNDERWRITER_ID,
				   PD_PRODUCT_ID,
				   CD_CUSTOMER_ID,
				   OS_OBJECT_STATE_ID,
				   PT_TERM_PREMIUM_TOTAL,
				   PT_EFF_DT,
				   PT_TYPE_NAME,
				   PT_CREATE_DT,
				   TRANS_ORDER,
				   trans_rn
			  FROM (SELECT PT_POLICY_ID,
						   PT_ID,
						   PE_PARTNER_ID,
						   UD_UNDERWRITER_ID,
						   PD_PRODUCT_ID,
						   CD_CUSTOMER_ID,
						   OS_OBJECT_STATE_ID,
						   PT_TERM_PREMIUM_TOTAL,
						   PT_EFF_DT,
						   PT_CREATE_DT,
						   PT_TYPE_NAME,
						   TRANS_ORDER,
						   row_number() over(partition by PT_POLICY_ID, trans_order order by pt_teff_dt desc) trans_rn
			   FROM
			(SELECT PT_POLICY_ID,
					PT_ID,
					PE_PARTNER_ID,
					UD_UNDERWRITER_ID,
					PD_PRODUCT_ID,
					CD_CUSTOMER_ID,
					OS_OBJECT_STATE_ID,
					PT_TERM_PREMIUM_TOTAL,
					PT_EFF_DT,
					PT_CREATE_DT,
					PT_TYPE_NAME,
					greatest(pt_eff_dt, pt_processed_dt) pt_teff_dt,
					-- 9, 8, 4 New Business, Renewal, Endorsement 
					 (case when pt_type_id in (9, 8, 4) and greatest(pt_eff_dt, pt_processed_dt) &lt;= trunc(sysdate) then 1
						   when pt_type_id in (9, 8, 4) and greatest(pt_eff_dt, pt_processed_dt) &gt; trunc(sysdate) then -1
						   else 3 end) trans_order
			FROM BI_FACT_POLICY_TRX_DETAIL
			WHERE (%OS_PARTNER_ID% is null OR %OS_PARTNER_ID% = 118 OR BI_FACT_POLICY_TRX_DETAIL.PE_PARTNER_ID = %OS_PARTNER_ID%) AND BI_FACT_POLICY_TRX_DETAIL.PT_TYPE_ID IN (8,9,4)
					 AND BI_FACT_POLICY_TRX_DETAIL.PT_EFF_DT >= add_months(trunc(sysdate), -12)
					 AND BI_FACT_POLICY_TRX_DETAIL.OS_OBJECT_STATE_ID IN (106)
					 AND PT_POLICY_ID IN (SELECT POD_POLICY_ID FROM bi_dim_policy_detail WHERE POD_POLICY_STATUS = 'Active')))
				WHERE
					(trans_rn = 1 and trans_order != -1)     
    </SQL> 
    </View>
    
    <DimensionUsage source="Dim_Broker" name="Broker" foreignKey="PE_PARTNER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Underwriter" name="Underwriter" foreignKey="UD_UNDERWRITER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Line_of_Business" name="Line of Business" foreignKey="PD_PRODUCT_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Dim_Customer" name="Customer" foreignKey="CD_CUSTOMER_ID" highCardinality="false">
    </DimensionUsage>
    <Dimension type="StandardDimension" visible="true" foreignKey="OS_OBJECT_STATE_ID" highCardinality="false" name="Status">
      <Hierarchy visible="true" hasAll="true">
        <Table name="BI_DIM_OBJECT_STATE">
        </Table>
        <Level name="Policy Status" visible="true" column="PT_STATUS" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Policy status">
        </Level>
        <Level name="Application Status" visible="true" column="OS_OBJECT_STATE_ID" nameColumn="OS_OBJECT_STATE_NAME" ordinalColumn="OS_OBJECT_STATE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Current state of Policy Transaction">
        </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension visible="true" foreignKey="PT_POLICY_ID" highCardinality="false" name="Policy_Jurisdiction" caption="Policy Jurisdiction">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Policies" primaryKey="POD_POLICY_ID">
        <Table name="BI_DIM_POLICY_DETAIL">
        </Table>
        <Level name="Jurisdiction" visible="true" column="POD_JURISDICTION_CODE" nameColumn="POD_JURISDICTION_CODE" ordinalColumn="POD_JURISDICTION_CODE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Jurisdiction">
        </Level>
      </Hierarchy>
    </Dimension>
	
    <Dimension visible="true" foreignKey="PT_POLICY_ID" highCardinality="false" name="Policy_Number" caption="Policy Number">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Policies" primaryKey="POD_POLICY_ID">
        <Table name="BI_DIM_POLICY_DETAIL">
        </Table>
        <Level name="Policy Number" visible="true" column="POD_POLICY_NUMBER" nameColumn="POD_POLICY_NUMBER" ordinalColumn="POD_POLICY_NUMBER" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Policy Number">
        </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension type="StandardDimension" highCardinality="false" name="No_of_days_till_expiry" caption="Number of Days till Expiry">
      <Hierarchy hasAll="true">
	   <Level name="Days till Expiry" visible="true" type="Numeric" uniqueMembers="true" levelType="Regular" hideMemberIf="Never"  caption="Days till Expiry" description="Number of Days till Expiry">
          <KeyExpression>
            <SQL dialect="oracle">
              <![CDATA[(trunc(pt_eff_dt + 365) - trunc(sysdate))]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>
    
	<Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="PT_ID" name="Creation Date" caption="Creation Date">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="PT_ID">
        <View alias="vw_policy_create_dt">
          <SQL dialect="generic">    
			   SELECT
			   PT_ID,
			   EXTRACT(YEAR FROM PT_CREATE_DT)       td_year,
			   to_number(to_char(PT_CREATE_DT, 'Q')) td_quarter,
			   'Q' || to_char(PT_CREATE_DT, 'Q')     td_quarter_name,
			   EXTRACT(MONTH FROM PT_CREATE_DT)      td_month,
			   to_char(PT_CREATE_DT, 'Mon')          td_month_name,
			   to_char(PT_CREATE_DT,'WW')            td_week,			   
			   EXTRACT(DAY FROM PT_CREATE_DT)        td_day,
			   PT_CREATE_DT                          td_date
			  FROM
			   BI_FACT_POLICY_TRX_DETAIL  			   
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Creation Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Creation Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Creation Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Creation Week" description="Creation Week">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level> 
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Date" description="Created On Date">
      </Level>
      </Hierarchy>
    </Dimension>
	
    <Measure name="Total_Policies" column="PT_POLICY_ID" datatype="Numeric" formatString="#,###" aggregator="distinct-count" caption="Total Active Policies Count" description="Total Policies">
    </Measure>
    <Measure name="Total_Premium" column="PT_TERM_PREMIUM_TOTAL" datatype="Numeric" formatString="$#,###" aggregator="sum" caption="Total Premium for Active Policies" description="Total Premium for Active Policies">
    </Measure>
	<Measure name="Average_Premium" column="PT_TERM_PREMIUM_TOTAL" datatype="Numeric" formatString="$#,###" aggregator="avg" caption="Average Premium for Active Policies" description="Average Premium for Active Policies">
	</Measure>
	
  </Cube>
  
   <Cube name="CANCELLED_POLICY_SUMMARY" caption="Cancelled Policy Summary" visible="true" cache="true" enabled="true">
    <Table name="BI_FACT_POLICY_TRX_DETAIL">
	<SQL dialect="generic"> 
         <![CDATA[((%OS_PARTNER_ID% is null OR %OS_PARTNER_ID% = 118 OR BI_FACT_POLICY_TRX_DETAIL.PE_PARTNER_ID = %OS_PARTNER_ID%) AND BI_FACT_POLICY_TRX_DETAIL.PT_TYPE_ID IN (1,2,4712))]]>           
    </SQL> 
    </Table>
    
    <DimensionUsage source="Dim_Broker" name="Broker" foreignKey="PE_PARTNER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Underwriter" name="Underwriter" foreignKey="UD_UNDERWRITER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Line_of_Business" name="Line of Business" foreignKey="PD_PRODUCT_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Dim_Customer" name="Customer" foreignKey="CD_CUSTOMER_ID" highCardinality="false">
    </DimensionUsage>
    <Dimension type="StandardDimension" visible="true" foreignKey="OS_OBJECT_STATE_ID" highCardinality="false" name="Status">
      <Hierarchy visible="true" hasAll="true">
        <Table name="BI_DIM_OBJECT_STATE">
        </Table>
        <Level name="Policy Status" visible="true" column="PT_STATUS" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Policy status">
        </Level>
        <Level name="Application Status" visible="true" column="OS_OBJECT_STATE_ID" nameColumn="OS_OBJECT_STATE_NAME" ordinalColumn="OS_OBJECT_STATE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Current state of Policy Transaction">
        </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension visible="true" foreignKey="PT_POLICY_ID" highCardinality="false" name="Policy_Jurisdiction" caption="Policy Jurisdiction">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Policies" primaryKey="POD_POLICY_ID">
        <Table name="BI_DIM_POLICY_DETAIL">
        </Table>
        <Level name="Jurisdiction" visible="true" column="POD_JURISDICTION_CODE" nameColumn="POD_JURISDICTION_CODE" ordinalColumn="POD_JURISDICTION_CODE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Jurisdiction">
        </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension visible="true" foreignKey="PT_POLICY_ID" highCardinality="false" name="Policy_Number" caption="Policy Number">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Policies" primaryKey="POD_POLICY_ID">
        <Table name="BI_DIM_POLICY_DETAIL">
        </Table>
        <Level name="Policy Number" visible="true" column="POD_POLICY_NUMBER" nameColumn="POD_POLICY_NUMBER" ordinalColumn="POD_POLICY_NUMBER" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Policy Number">
        </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension type="StandardDimension" highCardinality="false" name="cancellation_reasons" caption="Cancellation Reason">
      <Hierarchy hasAll="true">
        <Level name="Cancellation Reason" column="PT_CANCELLATION_REASON" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Cancellation Reason">
        </Level>
      </Hierarchy>
    </Dimension>
    
	<Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="PT_ID" name="Creation Date" caption="Creation Date">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="PT_ID">
        <View alias="vw_policy_create_dt">
          <SQL dialect="generic">    
			   SELECT
			   PT_ID,
			   EXTRACT(YEAR FROM PT_CREATE_DT)       td_year,
			   to_number(to_char(PT_CREATE_DT, 'Q')) td_quarter,
			   'Q' || to_char(PT_CREATE_DT, 'Q')     td_quarter_name,
			   EXTRACT(MONTH FROM PT_CREATE_DT)      td_month,
			   to_char(PT_CREATE_DT, 'Mon')          td_month_name,
			   to_char(PT_CREATE_DT,'WW')            td_week,			   
			   EXTRACT(DAY FROM PT_CREATE_DT)        td_day,
			   PT_CREATE_DT                          td_date
			  FROM
			   BI_FACT_POLICY_TRX_DETAIL  			   
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Creation Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Creation Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Creation Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Creation Week" description="Creation Week">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Date" description="Created On Date">
      </Level>
      </Hierarchy>
    </Dimension>
	
		<Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="PT_ID" name="Cancellation Processed Date" caption="Cancellation Processed Date">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="PT_ID">
        <View alias="vw_policy_cancel_processed_dt">
          <SQL dialect="generic">    
			   SELECT
			   PT_ID,
			   EXTRACT(YEAR FROM PT_PROCESSED_DT)       td_year,
			   to_number(to_char(PT_PROCESSED_DT, 'Q')) td_quarter,
			   'Q' || to_char(PT_PROCESSED_DT, 'Q')     td_quarter_name,
			   EXTRACT(MONTH FROM PT_PROCESSED_DT)      td_month,
			   to_char(PT_PROCESSED_DT, 'Mon')          td_month_name,
			   to_char(PT_PROCESSED_DT,'WW')            td_week,			   
			   EXTRACT(DAY FROM PT_PROCESSED_DT)        td_day,
			   PT_PROCESSED_DT                          td_date
			  FROM
			   BI_FACT_POLICY_TRX_DETAIL  			   
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Cancellation Processed Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Cancellation Processed Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Cancellation Processed Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Cancellation Processed Week" description="Cancellation Processed Week">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>		
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Cancellation Processed Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Cancellation Processed Date" description="Created On Date">
      </Level>
      </Hierarchy>
    </Dimension>
	
    <Measure name="Total_Cancelled_Policies" column="PT_POLICY_ID" datatype="Numeric" formatString="#,###" aggregator="distinct-count" caption="Total Cancelled Policies Count" description="Total Cancelled Policies">
    </Measure>
    <Measure name="Total_Cancelled_Premium" column="PT_TERM_PREMIUM_TOTAL" datatype="Numeric" formatString="$#,###" aggregator="sum" caption="Total Cancelled Premium" description="Total Cancelled Policies Premium">
    </Measure>

  </Cube>
  
  <Cube name="REJECTED_QUOTES" caption="Rejected Quotes" visible="true" cache="true" enabled="true">
    <Table name="BI_FACT_QUOTE_DETAIL">
	<SQL dialect="generic"> 
         <![CDATA[((%OS_PARTNER_ID% is null OR %OS_PARTNER_ID% = 118 OR BI_FACT_QUOTE_DETAIL.PE_PARTNER_ID = %OS_PARTNER_ID%) AND BI_FACT_QUOTE_DETAIL.os_object_state_id IN (23005))]]>           
      </SQL>
    </Table>
    
    <DimensionUsage source="Dim_Broker" name="Broker" foreignKey="PE_PARTNER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Underwriter" name="Underwriter" foreignKey="UD_UNDERWRITER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Line_of_Business" name="Line of Business" foreignKey="PD_PRODUCT_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Dim_Customer" name="Customer" foreignKey="CD_CUSTOMER_ID" highCardinality="false">
    </DimensionUsage>
    <Dimension type="StandardDimension" visible="true" foreignKey="OS_OBJECT_STATE_ID" highCardinality="false" name="Status">
      <Hierarchy visible="true" hasAll="true">
        <Table name="BI_DIM_OBJECT_STATE">
        </Table>
        <Level name="Quote Status" visible="true" column="OS_QUOTE_STATUS" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Quote status">
        </Level>
        <Level name="Application Status" visible="true" column="OS_OBJECT_STATE_ID" nameColumn="OS_OBJECT_STATE_NAME" ordinalColumn="OS_OBJECT_STATE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Current state of quote">
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension type="StandardDimension" highCardinality="false" name="Submission_Jurisdiction" caption="Submission Jurisdiction">
      <Hierarchy hasAll="true">
        <Level name="Jurisdiction" column="QD_PROD_JURISDICTION_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Jurisdiction">
        </Level>
      </Hierarchy>
    </Dimension>
	<Dimension type="StandardDimension" highCardinality="false" name="rejection_reasons" caption="Rejection Reason">
      <Hierarchy hasAll="true">
        <Level name="Rejection Reason" column="QD_POLICY_REJECTION_REASON" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Rejection Reason">
        </Level>
      </Hierarchy>
    </Dimension>
	
    <Dimension type="StandardDimension" highCardinality="false" name="Quote" caption="Quote">
      <Hierarchy hasAll="true">
        <Level name="Quote Name" column="QD_QUOTE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Quote Name">
        </Level>
	    <Level name="Quote Number" column="QD_POLICYQUOTE_NUMBER" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Quote Number">
        </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="QD_QUOTE_ID" name="Creation Date" caption="Creation Date">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="QD_QUOTE_ID">
        <View alias="vw_quote_create_dt">
          <SQL dialect="generic">    
			   SELECT
			   QD_QUOTE_ID,
			   EXTRACT(YEAR FROM QD_CREATE_DT)       td_year,
			   to_number(to_char(QD_CREATE_DT, 'Q')) td_quarter,
			   'Q' || to_char(QD_CREATE_DT, 'Q')     td_quarter_name,
			   EXTRACT(MONTH FROM QD_CREATE_DT)      td_month,
			   to_char(QD_CREATE_DT, 'Mon')          td_month_name,
			   to_char(QD_CREATE_DT,'WW')            td_week,
			   EXTRACT(DAY FROM QD_CREATE_DT)        td_day,
			   QD_CREATE_DT                          td_date
			  FROM
			   BI_FACT_QUOTE_DETAIL Q
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Creation Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Creation Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Creation Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Creation Week" description="Week of the Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Date" description="Created Date">
      </Level>
      </Hierarchy>
    </Dimension>
    
    <Measure name="Total_Rejected_Quotes" column="QD_QUOTE_ID" datatype="Numeric" formatString="#,###" aggregator="count" caption="Rejected Quotes Count" description="Total Rejected Quotes">
    </Measure>
    <Measure name="Total_Premium" column="QD_PREMIUM_AMT" datatype="Numeric" formatString="$#,###" aggregator="sum" caption="Total Premium" description="Rejected Submissions Premium">
    </Measure>
  </Cube>

  <Cube name="EXPIRED_QUOTES" caption="Expired Quotes" visible="true" cache="true" enabled="true">
    <Table name="BI_FACT_QUOTE_DETAIL">
	<SQL dialect="generic"> 
         <![CDATA[((%OS_PARTNER_ID% is null OR %OS_PARTNER_ID% = 118 OR BI_FACT_QUOTE_DETAIL.PE_PARTNER_ID = %OS_PARTNER_ID%) AND BI_FACT_QUOTE_DETAIL.os_object_state_id IN (40446))]]>           
      </SQL>
    </Table>
    
    <DimensionUsage source="Dim_Broker" name="Broker" foreignKey="PE_PARTNER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Underwriter" name="Underwriter" foreignKey="UD_UNDERWRITER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Line_of_Business" name="Line of Business" foreignKey="PD_PRODUCT_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Dim_Customer" name="Customer" foreignKey="CD_CUSTOMER_ID" highCardinality="false">
    </DimensionUsage>
    <Dimension type="StandardDimension" visible="true" foreignKey="OS_OBJECT_STATE_ID" highCardinality="false" name="Status">
      <Hierarchy visible="true" hasAll="true">
        <Table name="BI_DIM_OBJECT_STATE">
        </Table>
        <Level name="Quote Status" visible="true" column="OS_QUOTE_STATUS" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Quote status">
        </Level>
        <Level name="Application Status" visible="true" column="OS_OBJECT_STATE_ID" nameColumn="OS_OBJECT_STATE_NAME" ordinalColumn="OS_OBJECT_STATE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Current state of quote">
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension type="StandardDimension" highCardinality="false" name="Submission_Jurisdiction" caption="Submission Jurisdiction">
      <Hierarchy hasAll="true">
        <Level name="Jurisdiction" column="QD_PROD_JURISDICTION_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Jurisdiction">
        </Level>
      </Hierarchy>
    </Dimension>
	<Dimension type="StandardDimension" highCardinality="false" name="expired_reasons" caption="Expired Reason">
      <Hierarchy hasAll="true">
        <Level name="Expired Reason" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Expired Reason">
        <KeyExpression>
			<SQL dialect="oracle">
			<![CDATA[( case when 1=1 then'Lapsed' else 'N/A' end)
							  ]]>
			</SQL>
			</KeyExpression>
		</Level> 
      </Hierarchy>
    </Dimension> 
	
    <Dimension type="StandardDimension" highCardinality="false" name="Quote" caption="Quote">
      <Hierarchy hasAll="true">
        <Level name="Quote Name" column="QD_QUOTE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Quote Name">
        </Level>
	    <Level name="Quote Number" column="QD_POLICYQUOTE_NUMBER" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Quote Number">
        </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="QD_QUOTE_ID" name="Creation Date" caption="Creation Date">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="QD_QUOTE_ID">
        <View alias="vw_quote_create_dt">
          <SQL dialect="generic">    
			   SELECT
			   QD_QUOTE_ID,
			   EXTRACT(YEAR FROM QD_CREATE_DT)       td_year,
			   to_number(to_char(QD_CREATE_DT, 'Q')) td_quarter,
			   'Q' || to_char(QD_CREATE_DT, 'Q')     td_quarter_name,
			   EXTRACT(MONTH FROM QD_CREATE_DT)      td_month,
			   to_char(QD_CREATE_DT, 'Mon')          td_month_name,
			   to_char(QD_CREATE_DT,'WW')            td_week,
			   EXTRACT(DAY FROM QD_CREATE_DT)        td_day,
			   QD_CREATE_DT                          td_date
			  FROM
			   BI_FACT_QUOTE_DETAIL Q
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Creation Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Creation Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Creation Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Creation Week" description="Week of the Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Date" description="Created Date">
      </Level>
      </Hierarchy>
    </Dimension>
    
    <Measure name="Total_Expired_Quotes" column="QD_QUOTE_ID" datatype="Numeric" formatString="#,###" aggregator="count" caption=" Total Expired Quotes Count" description="Total Expired Quote Count">
    </Measure>
    <Measure name="Total_Premium" column="QD_PREMIUM_AMT" datatype="Numeric" formatString="$#,###" aggregator="sum" caption="Total Expired Premium" description="Total Expired Quotes Premium">
    </Measure>
  </Cube>
  
   <Cube name="NON-CONVERTED_QUOTES" caption="Non-Converted Quotes" visible="true" cache="true" enabled="true">
    <Table name="BI_FACT_QUOTE_DETAIL">
	<SQL dialect="generic"> 
         <![CDATA[((%OS_PARTNER_ID% is null OR %OS_PARTNER_ID% = 118 OR BI_FACT_QUOTE_DETAIL.PE_PARTNER_ID = %OS_PARTNER_ID%) AND BI_FACT_QUOTE_DETAIL.os_object_state_id IN (40446,23005,85,61548))]]>           
      </SQL>
    </Table>
    
    <DimensionUsage source="Dim_Broker" name="Broker" foreignKey="PE_PARTNER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Underwriter" name="Underwriter" foreignKey="UD_UNDERWRITER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Line_of_Business" name="Line of Business" foreignKey="PD_PRODUCT_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Dim_Customer" name="Customer" foreignKey="CD_CUSTOMER_ID" highCardinality="false">
    </DimensionUsage>
    <Dimension type="StandardDimension" visible="true" foreignKey="OS_OBJECT_STATE_ID" highCardinality="false" name="Status">
      <Hierarchy visible="true" hasAll="true">
        <Table name="BI_DIM_OBJECT_STATE">
        </Table>
        <Level name="Application Status" visible="true" column="OS_OBJECT_STATE_ID" nameColumn="OS_OBJECT_STATE_NAME" ordinalColumn="OS_OBJECT_STATE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Current state of quote">
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension type="StandardDimension" highCardinality="false" name="Submission_Jurisdiction" caption="Submission Jurisdiction">
      <Hierarchy hasAll="true">
        <Level name="Jurisdiction" column="QD_PROD_JURISDICTION_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Jurisdiction">
        </Level>
      </Hierarchy>
    </Dimension>
	<Dimension type="StandardDimension" highCardinality="false" name="expired_reasons" caption="Non-Converted Reason">
      <Hierarchy hasAll="true">
        <Level name="Non-Converted Reason" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Reason">
        <KeyExpression>
			<SQL dialect="oracle">
			<![CDATA[( case when BI_FACT_QUOTE_DETAIL.os_object_state_id = 40446 then 'Lapsed' 
							when BI_FACT_QUOTE_DETAIL.os_object_state_id = 23005 then QD_POLICY_REJECTION_REASON
							when BI_FACT_QUOTE_DETAIL.os_object_state_id = 85 then QD_DECLINE_REASON 
							when BI_FACT_QUOTE_DETAIL.os_object_state_id = 61548 then 'Quote Cancelled' 
							else 'N/A' end)
							  ]]>
			</SQL>
			</KeyExpression>
		</Level> 
      </Hierarchy>
    </Dimension> 
	
    <Dimension type="StandardDimension" highCardinality="false" name="Quote" caption="Quote">
      <Hierarchy hasAll="true">
        <Level name="Quote Name" column="QD_QUOTE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Quote Name">
        </Level>
	    <Level name="Quote Number" column="QD_POLICYQUOTE_NUMBER" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Quote Number">
        </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="QD_QUOTE_ID" name="Creation Date" caption="Creation Date">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="QD_QUOTE_ID">
        <View alias="vw_quote_create_dt">
          <SQL dialect="generic">    
			   SELECT
			   QD_QUOTE_ID,
			   EXTRACT(YEAR FROM QD_CREATE_DT)       td_year,
			   to_number(to_char(QD_CREATE_DT, 'Q')) td_quarter,
			   'Q' || to_char(QD_CREATE_DT, 'Q')     td_quarter_name,
			   EXTRACT(MONTH FROM QD_CREATE_DT)      td_month,
			   to_char(QD_CREATE_DT, 'Mon')          td_month_name,
			   to_char(QD_CREATE_DT,'WW')            td_week,
			   EXTRACT(DAY FROM QD_CREATE_DT)        td_day,
			   QD_CREATE_DT                          td_date
			  FROM
			   BI_FACT_QUOTE_DETAIL Q
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Creation Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Creation Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Creation Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Creation Week" description="Week of the Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Date" description="Created Date">
      </Level>
      </Hierarchy>
    </Dimension>
    
    <Measure name="Total_NonConverted_Quotes" column="QD_QUOTE_ID" datatype="Numeric" formatString="#,###" aggregator="count" caption=" Total Non-Converted Quotes Count" description="Total Non-Converted Quote Count">
    </Measure>
    <Measure name="Total_NonConverted_Premium" column="QD_PREMIUM_AMT" datatype="Numeric" formatString="$#,###" aggregator="sum" caption="Total Non-Converted Premium" description="Total Non-Converted Quotes Premium">
    </Measure>
  </Cube>

   <Cube name="NONRENEWAL_POLICY_SUMMARY" caption="Non-Renewal Policy Summary" visible="true" cache="true" enabled="true">
    <Table name="BI_FACT_POLICY_TRX_DETAIL">
	<SQL dialect="generic"> 
         <![CDATA[((%OS_PARTNER_ID% is null OR %OS_PARTNER_ID% = 118 OR BI_FACT_POLICY_TRX_DETAIL.PE_PARTNER_ID = %OS_PARTNER_ID%) AND BI_FACT_POLICY_TRX_DETAIL.PT_TYPE_ID IN (2207))]]>           
    </SQL> 
    </Table>
    
    <DimensionUsage source="Dim_Broker" name="Broker" foreignKey="PE_PARTNER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Underwriter" name="Underwriter" foreignKey="UD_UNDERWRITER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Line_of_Business" name="Line of Business" foreignKey="PD_PRODUCT_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Dim_Customer" name="Customer" foreignKey="CD_CUSTOMER_ID" highCardinality="false">
    </DimensionUsage>
    <Dimension type="StandardDimension" visible="true" foreignKey="OS_OBJECT_STATE_ID" highCardinality="false" name="Status">
      <Hierarchy visible="true" hasAll="true">
        <Table name="BI_DIM_OBJECT_STATE">
        </Table>
        <Level name="Policy Status" visible="true" column="PT_STATUS" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Policy status">
        </Level>
        <Level name="Application Status" visible="true" column="OS_OBJECT_STATE_ID" nameColumn="OS_OBJECT_STATE_NAME" ordinalColumn="OS_OBJECT_STATE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Current state of Policy Transaction">
        </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension visible="true" foreignKey="PT_POLICY_ID" highCardinality="false" name="Policy_Jurisdiction" caption="Policy Jurisdiction">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Policies" primaryKey="POD_POLICY_ID">
        <Table name="BI_DIM_POLICY_DETAIL">
        </Table>
        <Level name="Jurisdiction" visible="true" column="POD_JURISDICTION_CODE" nameColumn="POD_JURISDICTION_CODE" ordinalColumn="POD_JURISDICTION_CODE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Jurisdiction">
        </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension visible="true" foreignKey="PT_POLICY_ID" highCardinality="false" name="Policy_Number" caption="Policy Number">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Policies" primaryKey="POD_POLICY_ID">
        <Table name="BI_DIM_POLICY_DETAIL">
        </Table>
        <Level name="Policy Number" visible="true" column="POD_POLICY_NUMBER" nameColumn="POD_POLICY_NUMBER" ordinalColumn="POD_POLICY_NUMBER" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Policy Number">
        </Level>
      </Hierarchy>
    </Dimension>	
	
	<Dimension type="StandardDimension" highCardinality="false" name="nonrenewal_reasons" caption="Non-Renewal Reason">
      <Hierarchy hasAll="true">
        <Level name="Non-Renewal Reason" column="PT_NONRENEWAL_REASON" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Non-Renewal Reason">
        </Level>
      </Hierarchy>
    </Dimension>
    
	<Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="PT_ID" name="Creation Date" caption="Creation Date">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="PT_ID">
        <View alias="vw_policy_create_dt">
          <SQL dialect="generic">    
			   SELECT
			   PT_ID,
			   EXTRACT(YEAR FROM PT_CREATE_DT)       td_year,
			   to_number(to_char(PT_CREATE_DT, 'Q')) td_quarter,
			   'Q' || to_char(PT_CREATE_DT, 'Q')     td_quarter_name,
			   EXTRACT(MONTH FROM PT_CREATE_DT)      td_month,
			   to_char(PT_CREATE_DT, 'Mon')          td_month_name,
			   to_char(PT_CREATE_DT,'WW')            td_week,
			   EXTRACT(DAY FROM PT_CREATE_DT)        td_day,
			   PT_CREATE_DT                          td_date
			  FROM
			   BI_FACT_POLICY_TRX_DETAIL  			   
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Creation Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Creation Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Creation Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Creation Week" description="Week of the Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Date" description="Created On Date">
      </Level>
      </Hierarchy>
    </Dimension>
	
    <Measure name="Total_NonRenewed_Policies" column="PT_POLICY_ID" datatype="Numeric" formatString="#,###" aggregator="distinct-count" caption="Total Non-Renewal Policies Count" description="Total Non-Renewal Policies">
    </Measure>
    <Measure name="Total_NonRenewed_Premium" column="PT_TERM_PREMIUM_TOTAL" datatype="Numeric" formatString="$#,###" aggregator="sum" caption="Total Non-Renewal Premium" description="Total Non-Renewal Policies Premium">
    </Measure>
  </Cube>
  
   <Cube name="CUSTOMER_SUMMARY" caption="Customer Summary" visible="true" cache="true" enabled="true">
   	<View alias="vw_customer_summary">
          <SQL dialect="generic">  
SELECT
  PE_PARTNER_ID,
  UD_UNDERWRITER_ID,
  PD_PRODUCT_ID,
  CD_CUSTOMER_ID,
  PT_POLICY_ID,
  PT_TERM_PREMIUM_TOTAL,
  PT_TYPE_NAME,
  PT_ID,
  pt_eff_dt,
  POLICY_COUNT,
  TRANS_ORDER,
  trans_rn
 FROM
( SELECT
		 PE_PARTNER_ID,
         UD_UNDERWRITER_ID,
         PD_PRODUCT_ID,
         CD_CUSTOMER_ID,
         PT_POLICY_ID,
         PT_TERM_PREMIUM_TOTAL,
         PT_TYPE_NAME,
		 PT_ID,
		 pt_eff_dt,
         POLICY_COUNT,
         TRANS_ORDER,
         row_number() over (partition by PT_POLICY_ID, trans_order order by pt_eff_dt desc) trans_rn
			   FROM
			(  SELECT PE_PARTNER_ID,
						   UD_UNDERWRITER_ID,
						   PD_PRODUCT_ID,
						   CD_CUSTOMER_ID,
						   PT_POLICY_ID,
						   PT_TERM_PREMIUM_TOTAL,
						   PT_TYPE_NAME,
						   PT_ID,
					   (count(distinct PT_POLICY_ID) OVER (PARTITION BY cd_customer_id)) as POLICY_COUNT,
								 greatest(pt_eff_dt, pt_processed_dt) pt_eff_dt,
					  -- 9, 8, 4 New Business, Renewal, Endorsement 
					  (case when pt_type_id in (9, 8, 4) and greatest(pt_eff_dt, pt_processed_dt) &lt;= trunc(sysdate) then 1
						   when pt_type_id in (9, 8, 4) and greatest(pt_eff_dt, pt_processed_dt) &gt; trunc(sysdate) then -1
						   else 3 end) trans_order
					FROM BI_FACT_POLICY_TRX_DETAIL
					WHERE BI_FACT_POLICY_TRX_DETAIL.PT_TYPE_ID IN (9,8,4)
					--(5099, 1, 2, 4, 9, 3, 11, 3604, 3902, 8)
					 AND BI_FACT_POLICY_TRX_DETAIL.OS_OBJECT_STATE_ID IN (106)
					 AND BI_FACT_POLICY_TRX_DETAIL.PT_EFF_DT >= add_months(trunc(sysdate), -12)
					 AND PT_POLICY_ID IN (SELECT POD_POLICY_ID  FROM bi_dim_policy_detail WHERE POD_POLICY_STATUS = 'Active')
					 AND (%OS_PARTNER_ID% is null OR %OS_PARTNER_ID% = 118 OR BI_FACT_POLICY_TRX_DETAIL.PE_PARTNER_ID = %OS_PARTNER_ID%)))
				WHERE
					(trans_rn = 1 and trans_order != -1)
		  </SQL>
	</View>
    <DimensionUsage source="Dim_Broker" name="Broker" foreignKey="PE_PARTNER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Underwriter" name="Underwriter" foreignKey="UD_UNDERWRITER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Line_of_Business" name="Line of Business" foreignKey="PD_PRODUCT_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Dim_Customer" name="Customer" foreignKey="CD_CUSTOMER_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Dim_Policy" name="Policy" foreignKey="PT_POLICY_ID" highCardinality="false">
    </DimensionUsage>
    
   <Dimension visible="true" foreignKey="CD_CUSTOMER_ID" highCardinality="false" name="Jurisdiction" caption="Jurisdiction">
    <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="CD_CUSTOMER_ID" primaryKeyTable="BI_DIM_CUSTOMER_DETAIL">
      <Join leftKey="CD_PRIMARY_ADDRESS_ID" rightKey="AD_ADDRESS_ID">
        <Table name="BI_DIM_CUSTOMER_DETAIL">
        </Table>
        <Table name="BI_DIM_ADDRESS_DETAIL" alias="Address">
        </Table>
      </Join>
      <Level name="Jurisdiction" visible="true" table="Address" column="AD_JURISDICTION_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Jurisdiction" description="Jurisdiction">  
      </Level>
    </Hierarchy>
   </Dimension>
   
   	<Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="CD_CUSTOMER_ID" name="Creation Date" caption="Creation Date">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="CD_CUSTOMER_ID">
        <View alias="vw_customer_create_dt">
          <SQL dialect="generic">    
			   SELECT
			   CD_CUSTOMER_ID,
			   EXTRACT(YEAR FROM CD_PROSPECT_START_DT)       td_year,
			   to_number(to_char(CD_PROSPECT_START_DT, 'Q')) td_quarter,
			   'Q' || to_char(CD_PROSPECT_START_DT)     td_quarter_name,
			   EXTRACT(MONTH FROM CD_PROSPECT_START_DT)      td_month,
			   to_char(CD_PROSPECT_START_DT, 'Mon')          td_month_name,
			   to_char(CD_PROSPECT_START_DT,'WW')            td_week,
			   EXTRACT(DAY FROM CD_PROSPECT_START_DT)        td_day,
			   CD_PROSPECT_START_DT                          td_date
			  FROM
			   BI_DIM_CUSTOMER_DETAIL  			   
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Creation Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Creation Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Creation Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Creation Week" description="Week of the Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Date" description="Created On Date">
      </Level>
      </Hierarchy>
    </Dimension>
		
    <Measure name="Total_Customers" column="CD_CUSTOMER_ID" datatype="Numeric" formatString="#,###" aggregator="distinct-count" caption="Total Active Customer Count" description="Total Active Customer">
    </Measure>
    <Measure name="Total_Premium" column="PT_TERM_PREMIUM_TOTAL" datatype="Numeric" formatString="$#,###" aggregator="sum" caption="Total Active Policy Premium" description="Total Active Policies Premium">
    </Measure>
	<Measure name="Average_Premium" column="PT_TERM_PREMIUM_TOTAL" datatype="Numeric" formatString="$#,###" aggregator="avg" caption="Average Active Policy Premium" description="Average Active Policies Premium">
    </Measure>
	<Measure name="Avg_Policies_Per_Customer" column="POLICY_COUNT" datatype="Numeric" formatString="#,###.0" aggregator="avg" caption="Average Policy Per Customer" description="Average Count of Policies Per Customer">
    </Measure>
	
  </Cube>

   <Cube name="LOSS_RATIO_SUMMARY" caption="Loss Ratio Summary" visible="true" cache="true" enabled="true">
	<View alias="vw_loss_ratio">
          <SQL dialect="generic">    
			select
				pod_policy_id,
				pe_partner_id,
				coverage_id,
				pod_primary_risk_state,
				pod_policy_eff_date,
				pod_policy_product_name,
				pod_policy_uw_name,
				earned_amt,
				total_incurred_amt
				--,
				--nvl(round(nvl(total_incurred_amt, 0)/(case when earned_amt = 0 then 1 else earned_amt end), 2), 0) loss_ratio
			from
				(select
					all_rows.pod_policy_id,
					all_rows.pe_partner_id,
					all_rows.coverage_id,
					all_rows.pod_primary_risk_state,
					all_rows.pod_policy_eff_date,
					all_rows.pod_policy_product_name,
					all_rows.pod_policy_uw_name,
					round(sum(all_rows.earned_amount), 2) earned_amt 
				from
					(   
					 select
						 pearn.policy_id pod_policy_id,
						 pearn.coverage_id,
						 pod.pe_partner_id,
						 pod.pod_policy_eff_date,
						 pod.pod_primary_risk_state,
						 pod.pod_policy_product_name,
						 pod.pod_policy_uw_name,
						 trunc(pearn.calc_date, 'DD')                                                                  calc_date,
						 trunc(least(pearn.calc_date, last_day(sysdate)), 'DD')                                         target_dt,
						 pearn.earned_amount                                                                           earned_amount,                                                
						 pearn.unearned_amount                                                                   unearned_amount                                                                                      
					 from
						 bi_fact_policy_earning_dtls     pearn
					 inner join 
						 bi_dim_policy_detail            pod on 
							( 
									   pearn.policy_id = pod.pod_policy_id
							 )
					) all_rows
				where
					( trunc(all_rows.calc_date,'DD')   = trunc(all_rows.target_dt,'DD'))
				and
					all_rows.pod_policy_eff_date >= add_months(trunc(sysdate), -12)
				group by
					    all_rows.pod_policy_id,
					    all_rows.pe_partner_id,
					    all_rows.coverage_id,
					    all_rows.pod_policy_eff_date,
					    all_rows.pod_primary_risk_state,
					    all_rows.pod_policy_product_name,
					    all_rows.pod_policy_uw_name) pod,
			(Select
				sc_policy_id, sc_claim_coverage_id, sum(sc_total_incurred_amt) total_incurred_amt 
			from
				bi_fact_oc_subclaim_detail
			group by sc_policy_id, sc_claim_coverage_id) cl
			where
				pod.pod_policy_id = cl.sc_policy_id(+)
	 </SQL>
        </View>
      
   	<Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="POD_POLICY_ID" name="Effective Date" caption="Effective Date">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="POD_POLICY_ID">
        <View alias="vw_customer_create_dt">
          <SQL dialect="generic">    
			   SELECT
			   pod_policy_id,
			   EXTRACT(YEAR FROM pod_policy_eff_date)       td_year,
			   to_number(to_char(pod_policy_eff_date, 'Q')) td_quarter,
			   'Q' || to_char(pod_policy_eff_date)     td_quarter_name,
			   EXTRACT(MONTH FROM pod_policy_eff_date)      td_month,
			   to_char(pod_policy_eff_date, 'Mon')          td_month_name,
			   to_char(pod_policy_eff_date,'WW')            td_week,
			   EXTRACT(DAY FROM pod_policy_eff_date)        td_day,
			   pod_policy_eff_date                          td_date
			  FROM
			   bi_dim_policy_detail
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Week" description="Week of the Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Date" description="Date">
      </Level>
      </Hierarchy>
    </Dimension>

    <DimensionUsage source="Dim_Coverage" name="Coverage" foreignKey="COVERAGE_ID" highCardinality="false">
    </DimensionUsage>
    
    <DimensionUsage source="Dim_Broker" name="Broker" foreignKey="PE_PARTNER_ID" highCardinality="false">
    </DimensionUsage>
    
    <Dimension type="StandardDimension" highCardinality="false" name="State" caption="State">
      <Hierarchy hasAll="true">
        <Level name="State" column="POD_PRIMARY_RISK_STATE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="State">
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension type="StandardDimension" highCardinality="false" name="Underwriter" caption="Underwriter">
      <Hierarchy hasAll="true">
        <Level name="Underwriter" column="POD_POLICY_UW_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Underwriter">
        </Level>
      </Hierarchy>
    </Dimension>
    
    <Dimension type="StandardDimension" highCardinality="false" name="Product" caption="Product">
      <Hierarchy hasAll="true">
        <Level name="Product" column="POD_POLICY_PRODUCT_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Product">
        </Level>
      </Hierarchy>
    </Dimension>
    
    <Measure name="total_earned_amt" column="EARNED_AMT" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Total Earned Amount" description="Total Earned Amount">
    </Measure>

    <Measure name="total_incurred_amt" column="TOTAL_INCURRED_AMT" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Total Incurred Amount" description="Total Incurred Amount">
    </Measure>
    
    <CalculatedMember name="Loss_Ratio" formatString="###.00%" caption="Loss Ratio%" formula="IIf( [Measures].[total_incurred_amt] = 0, null, ([Measures].[total_incurred_amt] / [Measures].[total_earned_amt]) )" dimension="Measures">
    </CalculatedMember>
  </Cube>
  
    <Cube name="QUOTE_PREMIUM_SUMMARY" caption="Submission Premium Summary" visible="true" cache="true" enabled="true">
	<View alias="vw_quote_premium_summary">
          <SQL dialect="generic">    
				select Q.QD_QUOTE_ID OBJECT_ID,
					 Q.PP_PRODUCER_ID,
					 Q.OS_OBJECT_STATE_ID,
					 Q.PE_BROKER_ID,
					 Q.UD_UNDERWRITER_ID,
					 Q.PE_PARTNER_ID,
					 Q.CD_CUSTOMER_ID,
					 Q.QD_PROGRAM_TYPE PROGRAM_TYPE,
					 Q.QD_PREMIUM_AMT PREMIUM_AMT,
					 'New Business' TRX_TYPE,
					 Q.PD_PRODUCT_ID,
					 Q.QD_CREATE_DT CREATED_DT,
					 Q.QD_PROD_JURISDICTION_NAME JURISDICTION,
					 Q.QD_POLICYQUOTE_NUMBER QUOTE_NUMBER,
					 NULL POLICY_NUMBER
				  from BI_FACT_QUOTE_DETAIL Q
				union
				select P.PT_ID OBJECT_ID,
					 P.PP_PRODUCER_ID,
					 P.OS_OBJECT_STATE_ID,
					 P.PE_BROKER_ID,
					 P.UD_UNDERWRITER_ID,
					 P.PE_PARTNER_ID,
					 P.Cd_Customer_Id,
					 P.PT_PROGRAM_TYPE PROGRAM_TYPE,
					 P.PT_TERM_PREMIUM PREMIUM_AMT,
					 P.PT_TYPE_NAME TRX_TYPE,
					 P.PD_PRODUCT_ID,
					 P.PT_CREATE_DT CREATED_DT,
					 POD.POD_JURISDICTION_CODE JURISDICTION,
					 NULL QUOTE_NUMBER,
					 POD.POD_POLICY_NUMBER POLICY_NUMBER       
				  from Bi_Fact_Policy_Trx_Detail P,BI_DIM_POLICY_DETAIL POD
				 where p.pt_type_id = 8 and pt_status in (15402,34902,35502,105,29005,29205,31715)
				 and POD.pod_policy_id = p.pt_policy_id  	   
	 </SQL>
        </View>
    
    <DimensionUsage source="Dim_Broker" name="Broker" foreignKey="PE_PARTNER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Underwriter" name="Underwriter" foreignKey="UD_UNDERWRITER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Line_of_Business" name="Line of Business" foreignKey="PD_PRODUCT_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Dim_Customer" name="Customer" foreignKey="CD_CUSTOMER_ID" highCardinality="false">
    </DimensionUsage>
    <Dimension type="StandardDimension" visible="true" foreignKey="OS_OBJECT_STATE_ID" highCardinality="false" name="Status">
      <Hierarchy visible="true" hasAll="true">
        <Table name="BI_DIM_OBJECT_STATE">
        </Table>
        <Level name="Application Status" visible="true" column="OS_OBJECT_STATE_ID" nameColumn="OS_OBJECT_STATE_NAME" ordinalColumn="OS_OBJECT_STATE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Current state of quote">
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension type="StandardDimension" highCardinality="false" name="quote_type" caption="Quote type">
      <Hierarchy hasAll="true">
        <Level name="Quote type" column="TRX_TYPE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Quote type">
        </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension type="StandardDimension" highCardinality="false" name="Submission_Jurisdiction" caption="Submission Jurisdiction">
      <Hierarchy hasAll="true">
        <Level name="Jurisdiction" column="JURISDICTION" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Jurisdiction">
        </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension type="StandardDimension" highCardinality="false" name="Policy_Number" caption="Policy Number">
      <Hierarchy hasAll="true">
        <Level name="Policy Number" column="POLICY_NUMBER" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Policy Number">
        </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension type="StandardDimension" highCardinality="false" name="Quote_Number" caption="Quote Number">
      <Hierarchy hasAll="true">
        <Level name="Quote Number" column="QUOTE_NUMBER" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Quote Number">
        </Level>
      </Hierarchy>
    </Dimension>

	<Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="OBJECT_ID" name="Creation Date" caption="Creation Date">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="OBJECT_ID">
        <View alias="vw_create_dt">
          <SQL dialect="generic">    
         SELECT
             QD_QUOTE_ID as OBJECT_ID,
             EXTRACT(YEAR FROM QD_CREATE_DT)     td_year,
             to_number(to_char(QD_CREATE_DT, 'Q')) td_quarter,
             'Q' || to_char(QD_CREATE_DT, 'Q')     td_quarter_name,
             EXTRACT(MONTH FROM QD_CREATE_DT)      td_month,
             to_char(QD_CREATE_DT, 'Mon')          td_month_name,
             to_char(QD_CREATE_DT,'WW')            td_week,
             EXTRACT(DAY FROM QD_CREATE_DT)        td_day,
             QD_CREATE_DT                          td_date
        FROM
         BI_FACT_QUOTE_DETAIL  
        UNION 
         SELECT
             PT_ID as OBJECT_ID,
             EXTRACT(YEAR FROM PT_CREATE_DT)       td_year,
             to_number(to_char(PT_CREATE_DT, 'Q')) td_quarter,
             'Q' || to_char(PT_CREATE_DT, 'Q')     td_quarter_name,
             EXTRACT(MONTH FROM PT_CREATE_DT)      td_month,
             to_char(PT_CREATE_DT, 'Mon')          td_month_name,
             to_char(PT_CREATE_DT,'WW')            td_week,
             EXTRACT(DAY FROM PT_CREATE_DT)        td_day,
             PT_CREATE_DT                          td_date
        FROM
         BI_FACT_POLICY_TRX_DETAIL  
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Creation Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Creation Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Creation Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Creation Week" description="Week of the Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Date" description="Created Date">
      </Level>
      </Hierarchy>
    </Dimension> 
    
    <Measure name="Total_Submissions" column="OBJECT_ID" datatype="Numeric" formatString="#,###" aggregator="count" caption="Total Submission Count" description="Total Rejected Quotes">
    </Measure>
    <Measure name="Total_Premium" column="PREMIUM_AMT" datatype="Numeric" formatString="$#,###" aggregator="sum" caption="Total Premium" description="Total Submissions Premium">
    </Measure>
	<Measure name="Average_Premium" column="PREMIUM_AMT" datatype="Numeric" formatString="$#,###" aggregator="avg" caption="Average Premium" description="Average Submissions Premium">
    </Measure>
  </Cube>
  
   <Cube name="PENDINGCANCEL_SUMMARY" caption="Pending Cancel Policy Summary" visible="true" cache="true" enabled="true">
    <View alias="vw_pendingcancel_summary">
        <SQL dialect="generic">    
		select BI_FACT_POLICY_TRX_DETAIL.PE_PARTNER_ID,
			   BI_FACT_POLICY_TRX_DETAIL.UD_UNDERWRITER_ID,
			   BI_FACT_POLICY_TRX_DETAIL.PD_PRODUCT_ID,
			   BI_FACT_POLICY_TRX_DETAIL.CD_CUSTOMER_ID,
			   BI_FACT_POLICY_TRX_DETAIL.OS_OBJECT_STATE_ID,
			   BI_FACT_POLICY_TRX_DETAIL.PT_STATUS,
			   BI_FACT_POLICY_TRX_DETAIL.PT_ID,
			   BI_FACT_POLICY_TRX_DETAIL.PT_CREATE_DT,
			   BI_FACT_POLICY_TRX_DETAIL.PT_TERM_PREMIUM_TOTAL,
			   BI_FACT_POLICY_TRX_DETAIL.PT_POLICY_ID,
			   BI_DIM_POLICY_DETAIL.POD_JURISDICTION_CODE,
			   BI_DIM_POLICY_DETAIL.POD_POLICY_NUMBER
		  from BI_FACT_POLICY_TRX_DETAIL,
			   BI_DIM_POLICY_DETAIL 
		 where PT_TYPE_ID IN (4212)
		   and BI_DIM_POLICY_DETAIL.pod_policy_status = 'PendingCancel'
		   and BI_DIM_POLICY_DETAIL.POD_POLICY_ID = BI_FACT_POLICY_TRX_DETAIL.PT_POLICY_ID
		   and (%OS_PARTNER_ID% is null OR %OS_PARTNER_ID% = 118 OR BI_FACT_POLICY_TRX_DETAIL.PE_PARTNER_ID = %OS_PARTNER_ID%)

	    </SQL>
    </View>
    
    <DimensionUsage source="Dim_Broker" name="Broker" foreignKey="PE_PARTNER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Underwriter" name="Underwriter" foreignKey="UD_UNDERWRITER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Line_of_Business" name="Line of Business" foreignKey="PD_PRODUCT_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Dim_Customer" name="Customer" foreignKey="CD_CUSTOMER_ID" highCardinality="false">
    </DimensionUsage>
    <Dimension type="StandardDimension" visible="true" foreignKey="OS_OBJECT_STATE_ID" highCardinality="false" name="Status">
      <Hierarchy visible="true" hasAll="true">
        <Table name="BI_DIM_OBJECT_STATE">
        </Table>
        <Level name="Policy Status" visible="true" column="PT_STATUS" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Policy status">
        </Level>
        <Level name="Application Status" visible="true" column="OS_OBJECT_STATE_ID" nameColumn="OS_OBJECT_STATE_NAME" ordinalColumn="OS_OBJECT_STATE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Current state of Policy Transaction">
        </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension type="StandardDimension" highCardinality="false" name="Policy_Jurisdiction" caption="Policy Jurisdiction">
      <Hierarchy hasAll="true">
        <Level name="Jurisdiction" column="POD_JURISDICTION_CODE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Jurisdiction">
        </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension visible="true" foreignKey="PT_POLICY_ID" highCardinality="false" name="Policy_Number" caption="Policy Number">
      <Hierarchy visible="true" hasAll="true">
        <Level name="Policy Number" visible="true" column="POD_POLICY_NUMBER" nameColumn="POD_POLICY_NUMBER" ordinalColumn="POD_POLICY_NUMBER" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Policy Number">
        </Level>
      </Hierarchy>
    </Dimension>
    
	<Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="PT_ID" name="Creation Date" caption="Creation Date">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="PT_ID">
        <View alias="vw_policy_create_dt">
          <SQL dialect="generic">    
			   SELECT
			   PT_ID,
			   EXTRACT(YEAR FROM PT_CREATE_DT)       td_year,
			   to_number(to_char(PT_CREATE_DT, 'Q')) td_quarter,
			   'Q' || to_char(PT_CREATE_DT, 'Q')     td_quarter_name,
			   EXTRACT(MONTH FROM PT_CREATE_DT)      td_month,
			   to_char(PT_CREATE_DT, 'Mon')          td_month_name,
			   to_char(PT_CREATE_DT,'WW')            td_week,
			   EXTRACT(DAY FROM PT_CREATE_DT)        td_day,
			   PT_CREATE_DT                          td_date
			  FROM
			   BI_FACT_POLICY_TRX_DETAIL  			   
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Creation Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Creation Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Creation Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Creation Week" description="Week of the Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Date" description="Created On Date">
      </Level>
      </Hierarchy>
    </Dimension>
	
    <Measure name="Total_PendingCancel_Policies" column="PT_POLICY_ID" datatype="Numeric" formatString="#,###" aggregator="distinct-count" caption="Total Pending Cancel Policies Count" description="Total Pending Cancel Policies">
    </Measure>
    <Measure name="Total_PendingCancel_Premium" column="PT_TERM_PREMIUM_TOTAL" datatype="Numeric" formatString="$#,###" aggregator="sum" caption="Total Pending Cancel Premium" description="Total Pending Cancel Policies Premium">
    </Measure>
  </Cube>
  
   
 
  <!-- ALL_PARTNERS --> 
	
  <Cube name="ALL_PARTNERS" caption="All Partners" visible="true" cache="true" enabled="true">
    <Table name="BI_DIM_PARTNER_ENTITY">
	   <SQL dialect="generic">
         <![CDATA[(%OS_PARTNER_ID% is null OR %OS_PARTNER_ID% = 118 OR bi_dim_partner_entity.PE_PARTNER_ID = %OS_PARTNER_ID%)
		         ]]>
	  </SQL>
    </Table>

    <DimensionUsage source="Dim_Address" name="Address" caption="Address" visible="true" foreignKey="PE_PARTNER_PRIMARY_ADD_ID" highCardinality="false">
    </DimensionUsage>
	
    <Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="PE_PARTNER_ID" name="Time (Effective Date)" caption="Time (Effective Date)">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="PE_PARTNER_ID">
        <View alias="vw_ptnr_eff_dt">
          <SQL dialect="generic">    
			   SELECT
					  PE_PARTNER_ID,
					  EXTRACT(YEAR FROM PE_PARTNER_EFF_DATE)          td_year,
					  to_number(to_char(PE_PARTNER_EFF_DATE, 'Q')) 	  td_quarter,
					  'Q' || to_char(PE_PARTNER_EFF_DATE, 'Q')        td_quarter_name,
					  EXTRACT(MONTH FROM PE_PARTNER_EFF_DATE)         td_month,
					  to_char(PE_PARTNER_EFF_DATE, 'Mon')             td_month_name,
					  to_char(PE_PARTNER_EFF_DATE,'WW')               td_week,			   
					  EXTRACT(DAY FROM PE_PARTNER_EFF_DATE)           td_day,
					  PE_PARTNER_EFF_DATE					          td_date
			  FROM
					  BI_DIM_PARTNER_ENTITY
          </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Effective Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Effective Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Effective Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Effective Week" description="Name of the Week">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Effective Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Effective Date" description="Effective Date">
      </Level>
      </Hierarchy>
    </Dimension>
	
	
	
    <Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="PE_PARTNER_ID" name="Time (Expiration Date)" caption="Time (Expiration Date)">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="PE_PARTNER_ID">
        <View alias="vw_ptnr_exp_dt">
          <SQL dialect="generic">    
			   SELECT
					  PE_PARTNER_ID,
					  EXTRACT(YEAR FROM PE_PARTNER_EXP_DATE)          td_year,
					  to_number(to_char(PE_PARTNER_EXP_DATE, 'Q')) 	  td_quarter,
					  'Q' || to_char(PE_PARTNER_EXP_DATE, 'Q')        td_quarter_name,
					  EXTRACT(MONTH FROM PE_PARTNER_EXP_DATE)         td_month,
					  to_char(PE_PARTNER_EXP_DATE, 'Mon')             td_month_name,
					  to_char(PE_PARTNER_EXP_DATE,'WW')               td_week,			   
					  EXTRACT(DAY FROM PE_PARTNER_EXP_DATE)           td_day,
					  PE_PARTNER_EXP_DATE					          td_date
			  FROM
					  BI_DIM_PARTNER_ENTITY
          </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Expiration Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Expiration Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Expiration Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Expiration Week" description="Name of the Week">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Expiration Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Expiration Date" description="Expiration Date">
      </Level>
      </Hierarchy>
    </Dimension>
    
 
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Partner Details" caption="Partner Details">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Partner Details">
        <Level name="Partner Name" visible="true" column="PE_PARTNER_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Partner Name" description="Name of Partner.">
        </Level>
        <Level name="Agency Code" visible="true" column="PE_PARTNER_CODE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Agency Code" description="Agency Code">
        </Level>
      </Hierarchy>
    </Dimension>
	
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="PartnerTypeDtls" caption="Partner Type Details">
      <Hierarchy visible="true" hasAll="true" allMemberName="Partner Type Details">
        <Level name="Partner Type" visible="true" column="PE_PARTNER_TYPE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Partner Type" description="Partner Type">
        </Level>
      </Hierarchy>
    </Dimension>	

    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="MarketingManagerDetails" caption="Marketing Manager Details">
      <Hierarchy visible="true" hasAll="true" allMemberName="Marketing Manager Details">
        <Level name="Marketing Manager" visible="true" column="PE_PARTNER_MKT_MANAGER_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Marketing Manager" description="Marketing Manager">
        </Level>
      </Hierarchy>
    </Dimension>	
	
	
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="AgencySubType" caption="Agency SubType Details">
      <Hierarchy visible="true" hasAll="true" allMemberName="SubType">
        <Level name="Agency SubType" visible="true" column="PE_PARTNER_SUB_TYPE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Agency SubType" description="Agency SubType">
          <KeyExpression>
            <SQL dialect="oracle">
              <![CDATA[(nvl(pe_partner_sub_type,pe_partner_type))
				      ]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>


    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="PartnerCategory" caption="PartnerCategory">
      <Hierarchy visible="true" hasAll="true" allMemberName="ServicePartner">
        <Level name="Service Partner" visible="true" column="PE_PARTNER_SUB_TYPE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Service Partner" description="Service Partner">
          <KeyExpression>
            <SQL dialect="oracle">
              <![CDATA[(case when nvl(pe_partner_sub_type,pe_partner_type) not in (
			                                                                           'Writing Company',
			                                                                           'General Ledger Account',
			                                                                           'Broker',
			                                                                           'Business Introducer',
			                                                                           'Wholesaler',
																					   'Wholesale Agent',
			                                                                           'Retail Agent',
			                                                                           'Carrier Branch Office',
			                                                                           'Aggregator', 
			                                                                           'Agent',
			                                                                           'Sub-Agent'
																					)   
						   then 'Servicing Partners'
					   else
						   'Sales & Marketing Partners'
				   end)
				  ]]>
            </SQL>
          </KeyExpression>
        </Level>
		
	  </Hierarchy>
    </Dimension>

 
    <Measure name="Approved_Partner_Count" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Approved Partner Count" description="Number of Approved Partners">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[case when pe_partner_object_state_id in (32905)  then 1 else 0 end]]>
        </SQL>
      </MeasureExpression>
    </Measure>
	
    <Measure name="Active_Partner_Count" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Active Partner Count" description="Number of Active Partners">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[case when pe_partner_object_state_id in (75)  then 1 else 0 end]]>
        </SQL>
      </MeasureExpression>
    </Measure>
	
    <Measure name="Terminated_Partner_Count" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Terminated Partner Count" description="Number of Terminated Partners">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[case when pe_partner_object_state_id in (31805,85748)  then 1 else 0 end]]>
        </SQL>
      </MeasureExpression>
    </Measure>	

    <Measure name="Prospect_Partner_Count" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Prospect Partner Count" description="Number of Prospect Partners">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[case when pe_partner_object_state_id in (33405)  then 1 else 0 end]]>
        </SQL>
      </MeasureExpression>
    </Measure>	 
 
  </Cube>

    
   <Cube name="ASSET_ANALYSIS_SUMMARY_AUTO" caption="Asset Analysis - Automobile" visible="true" cache="true" enabled="true">
    <View alias="vw_asset_analysis_summary">
        <SQL dialect="generic">    
		Select
			clt_id,
			pod_policy_id,
			cd_customer_id,
			pe_partner_id,
			pe_writing_company_id,
			pp_producer_id,
			ci_item_id,
			clt_transaction_type_name,
			clt_effective_date,
			clt_trx_eff_dt,
			clt_trx_processed_dt,
			co_coverage_id,
			clt_coverage_change_type,
			clt_earned_amt,
			clt_premium_written,
			cl.total_incurred_amt,
			ci_covered_item_asset_type,
			ci_covered_item_asset_name,
			vd_vehicle_vin_no,
			vd_vehicle_year,
			vd_vehicle_make,
			vd_vehicle_model,
			vd_vehicle_body_style,
			vd_vehicle_engine_size,
			vd_vehicle_primary_use,
			vd_vehicle_owner_type,
			ad_risk_address_id,
			trans_order,
			trans_rn
		from
			(select
				clt_id,
				pod_policy_id,
				cd_customer_id,
				pe_partner_id,
				pe_writing_company_id,
				pp_producer_id,
				ci_item_id,
				clt_transaction_type_name,
				clt_effective_date,
				clt_trx_eff_dt,
				clt_trx_processed_dt,
				co_coverage_id,
				clt_coverage_change_type,
				clt_earned_amt,
				clt_premium_written,
				ci_covered_item_asset_type,
				ci_covered_item_asset_name,
				vd_vehicle_vin_no,
				vd_vehicle_year,
				vd_vehicle_make,
				vd_vehicle_model,
				vd_vehicle_body_style,
				vd_vehicle_engine_size,
				vd_vehicle_primary_use,
				vd_vehicle_owner_type,
				ad_risk_address_id,
				trans_order,
				row_number() over (partition by pod_policy_id, trans_order order by pt_eff_dt desc) trans_rn
			from 
				(
				Select
					clt.clt_id,
					clt.pod_policy_id,
					clt.cd_customer_id,
					clt.pe_partner_id,
					clt.pe_writing_company_id,
					clt.pp_producer_id,
					clt.ci_item_id,
					clt.clt_transaction_type_name,
					clt.clt_effective_date,
					clt.clt_trx_eff_dt,
					clt.clt_trx_processed_dt,
					clt.co_coverage_id,
					clt.clt_coverage_change_type,
					clt.clt_earned_amt,
					clt.clt_change_amount clt_premium_written,
					ci.ci_covered_item_asset_type,
					ci.ci_covered_item_asset_name,
					vd.vd_vehicle_vin_no,
					vd.vd_vehicle_year,
					vd.vd_vehicle_make,
					vd.vd_vehicle_model,
					vd.vd_vehicle_body_style,
					vd.vd_vehicle_engine_size,
					vd.vd_vehicle_primary_use,
					vd.vd_vehicle_owner_type,
					ptd.ad_risk_address_id,
					greatest(ptd.pt_eff_dt, ptd.pt_processed_dt) pt_eff_dt,
					-- 9, 8, 4 New Business, Renewal, Endorsement 
					(case when ptd.pt_type_id in (9, 8, 4) and greatest(ptd.pt_eff_dt, ptd.pt_processed_dt) &lt;= trunc(sysdate) then 1
						   when ptd.pt_type_id in (9, 8, 4) and greatest(ptd.pt_eff_dt, ptd.pt_processed_dt) &gt; trunc(sysdate) then -1
						   else 3 end) trans_order
				from
					bi_fact_coverage_level_trx clt,
					bi_dim_covered_item ci,
					bi_dim_vehicle_detail vd,
					bi_fact_policy_trx_detail ptd
				where
					clt.ci_item_id = ci.ci_item_id
				and
					ci.ci_item_id = vd.vd_vehicle_id
				and 
					clt.pt_policy_transaction_id = ptd.pt_id
				and
					clt.clt_effective_date >= add_months(trunc(sysdate), -12))) va, 
				(Select
					sc_policy_id,
					sum(sc_total_incurred_amt) total_incurred_amt
				from
					bi_fact_oc_subclaim_detail
				group by sc_policy_id) cl
		where
			va.pod_policy_id = cl.sc_policy_id(+)
		and
			(trans_rn = 1 and trans_order != -1)
	    </SQL>
    </View>
    
    <DimensionUsage source="Dim_Broker" name="Broker" foreignKey="PE_PARTNER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Policy" name="Policy" foreignKey="POD_POLICY_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Dim_Address" name="Address" caption="Address" visible="true" foreignKey="AD_RISK_ADDRESS_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Dim_Coverage" name="Coverage Name" caption="Coverage Name" visible="true" foreignKey="CO_COVERAGE_ID" highCardinality="false">
    </DimensionUsage>
    
	<Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="CLT_ID" name="Effective Date" caption="Effective Date">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="CLT_ID">
        <View alias="vw_policytrx_effective_dt">
          <SQL dialect="generic">    
			   SELECT
			   CLT_ID,
			   EXTRACT(YEAR FROM CLT_EFFECTIVE_DATE)       td_year,
			   to_number(to_char(CLT_EFFECTIVE_DATE, 'Q')) td_quarter,
			   'Q' || to_char(CLT_EFFECTIVE_DATE, 'Q')     td_quarter_name,
			   EXTRACT(MONTH FROM CLT_EFFECTIVE_DATE)      td_month,
			   to_char(CLT_EFFECTIVE_DATE, 'Mon')          td_month_name,
			   to_char(CLT_EFFECTIVE_DATE,'WW')            td_week,
			   EXTRACT(DAY FROM CLT_EFFECTIVE_DATE)        td_day,
			   CLT_EFFECTIVE_DATE                          td_date
			  FROM
			   BI_FACT_COVERAGE_LEVEL_TRX  			   
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Effective Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Effective Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Effective Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Effective Week" description="Week of the Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Effective Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Effective Date" description="Created On Date">
      </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension type="StandardDimension" highCardinality="false" name="Transaction" caption="Transaction">
      <Hierarchy hasAll="true">
        <Level name="Coverage_Transaction_Name" column="CLT_TRANSACTION_TYPE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Transaction">
        </Level>
      </Hierarchy>
    </Dimension>
	
	
    <Dimension type="StandardDimension" highCardinality="false" name="Vehicle_Year" caption="Vehicle Year">
      <Hierarchy hasAll="true">
        <Level name="Year" column="VD_VEHICLE_YEAR" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Year">
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" highCardinality="false" name="Vehicle_Make" caption="Vehicle Make">
      <Hierarchy hasAll="true">
        <Level name="Make" column="VD_VEHICLE_MAKE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Make">
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" highCardinality="false" name="Vehicle_Model" caption="Vehicle Model">
      <Hierarchy hasAll="true">
        <Level name="Model" column="VD_VEHICLE_MODEL" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Model">
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" highCardinality="false" name="Vehicle_Type" caption="Vehicle Type">
      <Hierarchy hasAll="true">
        <Level name="Type" column="VD_VEHICLE_BODY_STYLE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Type">
        </Level>
      </Hierarchy>
    </Dimension>
    <Measure name="Total_Earned_Premium" column="CLT_EARNED_AMT" datatype="Numeric" formatString="$#,###" aggregator="sum" caption="Earned Premium" description="Earned Premium">
    </Measure>
	<Measure name="Total_Premium" column="CLT_PREMIUM_WRITTEN" datatype="Numeric" formatString="$#,###" aggregator="sum" caption="Total Premium" description="Total Premium">
    </Measure>
	<Measure name="Total_Policies" column="POD_POLICY_ID" datatype="Numeric" formatString="#,###" aggregator="distinct-count" caption="Total Policies" description="Total Policies">
    </Measure>
	<Measure name="Total_Incurred_Loss" column="TOTAL_INCURRED_AMT" datatype="Numeric" formatString="$#,###" aggregator="sum" caption="Total Incurred Loss" description="Total Incurred Loss">
    </Measure>
  </Cube>   
   
  
<!-- Partner License Details -->

<Cube name="Partner License" caption="Partner License" cache="true" enabled="true">
    <Table name="BI_FACT_PARTNER_MGT_LICENSE">
    </Table>
	
    <DimensionUsage source="Dim_Broker" name="Broker" foreignKey="PML_PARTNER_ID" highCardinality="false">
    </DimensionUsage>

	<Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="PML_ID" name="License Effective Date" caption="License Effective Date">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="PML_ID">
        <View alias="vw_license_effective_dt">
          <SQL dialect="generic">    
			   SELECT
			          PML_ID,
			          EXTRACT(YEAR FROM PML_EFF_DATE)       td_year,
			          to_number(to_char(PML_EFF_DATE, 'Q')) td_quarter,
			          'Q' || to_char(PML_EFF_DATE, 'Q')     td_quarter_name,
			          EXTRACT(MONTH FROM PML_EFF_DATE)      td_month,
			          to_char(PML_EFF_DATE, 'Mon')          td_month_name,
			          to_char(PML_EFF_DATE,'WW')            td_week,
			          EXTRACT(DAY FROM PML_EFF_DATE)        td_day,
			          PML_EFF_DATE                          td_date
			  FROM
			          BI_FACT_PARTNER_MGT_LICENSE  			   
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Effective Date Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Effective Date Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Effective Date Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Effective Date Week" description="Week of the Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Effective Date Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Effective Date" description="Created On Date">
      </Level>
      </Hierarchy>
    </Dimension>
		


	<Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="PML_ID" name="License Expiration Date" caption="License Expiration Date">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="PML_ID">
        <View alias="vw_license_expiration_dt">
          <SQL dialect="generic">    
			   SELECT
			          PML_ID,
			          EXTRACT(YEAR FROM PML_EXP_DATE)       td_year,
			          to_number(to_char(PML_EXP_DATE, 'Q')) td_quarter,
			          'Q' || to_char(PML_EXP_DATE, 'Q')     td_quarter_name,
			          EXTRACT(MONTH FROM PML_EXP_DATE)      td_month,
			          to_char(PML_EXP_DATE, 'Mon')          td_month_name,
			          to_char(PML_EXP_DATE,'WW')            td_week,
			          EXTRACT(DAY FROM PML_EXP_DATE)        td_day,
			          PML_EXP_DATE                          td_date
			  FROM
			          BI_FACT_PARTNER_MGT_LICENSE  			   
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Expiration Date Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Expiration Date Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Expiration Date Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Expiration Date Week" description="Week of the Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Expiration Date Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Expiration Date" description="Created On Date">
      </Level>
      </Hierarchy>
    </Dimension>
		


	<Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="PML_ID" name="License Entry Date" caption="License Entry Date">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="PML_ID">
        <View alias="vw_license_entry_dt">
          <SQL dialect="generic">    
			   SELECT
			          PML_ID,
			          EXTRACT(YEAR FROM PML_ENTRY_DATE)       td_year,
			          to_number(to_char(PML_ENTRY_DATE, 'Q')) td_quarter,
			          'Q' || to_char(PML_ENTRY_DATE, 'Q')     td_quarter_name,
			          EXTRACT(MONTH FROM PML_ENTRY_DATE)      td_month,
			          to_char(PML_ENTRY_DATE, 'Mon')          td_month_name,
			          to_char(PML_ENTRY_DATE,'WW')            td_week,
			          EXTRACT(DAY FROM PML_ENTRY_DATE)        td_day,
			          PML_ENTRY_DATE                          td_date
			  FROM
			          BI_FACT_PARTNER_MGT_LICENSE  			   
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Entry Date Year" description="Entry Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Entry Date Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Entry Date Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Entry Date Week" description="Week of the Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Entry Date Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Entry Date" description="Created On Date">
      </Level>
      </Hierarchy>
    </Dimension>
		

    <Dimension type="StandardDimension" highCardinality="false" name="Agency_Jurisdiction" caption="Agency Jurisdiction">
      <Hierarchy hasAll="true">
        <Level name="Agency Jurisdiction" column="PML_AGENCY_JURISDICTION" nameColumn="PML_AGENCY_JURISDICTION" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="The Jurisdiction where the Agency is registered">
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension type="StandardDimension" highCardinality="false" name="License_Jurisdiction" caption="License Jurisdiction">
      <Hierarchy hasAll="true">
        <Level name="License Jurisdiction" column="PML_LICENSE_JURISDICTION" nameColumn="PML_LICENSE_JURISDICTION" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="The Jurisdiction where the license was registered">
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension type="StandardDimension" highCardinality="false" name="License_LOB" caption="Line of Business">
      <Hierarchy hasAll="true">
        <Level name="License LOB" caption="Line of Business" column="PML_LINE_OF_BUSINESS" nameColumn="PML_LINE_OF_BUSINESS" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="The Line of Business where the license was registered">
        </Level>
      </Hierarchy>
    </Dimension>
    
    <Dimension type="StandardDimension" highCardinality="false" name="License_Type" caption="License Type">
      <Hierarchy hasAll="true">
        <Level name="License Type" column="PML_LICENSE_TYPE" nameColumn="PML_LICENSE_TYPE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="A license can be registed with the Agent or the Agency">
        </Level>
        <Level name="License Holder Name" column="PML_LICENSE_HOLDER_NAME" nameColumn="PML_LICENSE_HOLDER_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="The license holder Name">
        </Level>		
      </Hierarchy>
    </Dimension>

    <Dimension type="StandardDimension" highCardinality="false" name="License_Status" caption="License Status">
      <Hierarchy hasAll="true">
        <Level name="License Status" column="PML_LICENSE_STATUS" nameColumn="PML_LICENSE_STATUS" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Current status of the license">
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension type="StandardDimension" highCardinality="false" name="License_Category" caption="License Category">
      <Hierarchy hasAll="true">
        <Level name="License Category" column="PML_LICENSE_CATEGORY" nameColumn="PML_LICENSE_CATEGORY" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Category of the license">
        </Level>
      </Hierarchy>
    </Dimension>


    <Dimension type="StandardDimension" highCardinality="false" name="License_Expiry_Days" caption="License Expiry Days">
      <Hierarchy hasAll="true">
	   <Level name="License_Expiry_Days" visible="true" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never"  caption="License Expiry Days" description="License Expiry Days">
          <KeyExpression>
            <SQL dialect="oracle">
				  <![CDATA[(case when ((round(pml_exp_date - sysdate, 0) < 0) or (round(pml_exp_date - sysdate, 0) between 0 and 30))
						   then '30 days or less'
					   else
						   'More than 30 days'
				   end)
				  ]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>
        
    <Measure name="License_Count" column="PML_ID" datatype="Integer" formatString="#,###" aggregator="count" caption="License Count" description="Total number of Licences">
    </Measure>

</Cube>   


<!-- Partner Agreement Details -->

<Cube name="Partner Agreement" caption="Partner Agreement" cache="true" enabled="true">
    <View alias="VW_BI_FACT_PARTNER_MGT_AGREEMENT">
        <SQL dialect="generic">    
		Select
					pmp_agency_jurisdiction,
					pmp_agreement_id,
					pmp_agr_create_date,
					pmp_agr_eff_date,
					pmp_agr_exp_date,
					pmp_agr_jurisdiction,
					pmp_agr_status,
					pmp_agr_term_date,
					pmp_agr_title,
					pmp_line_of_business,
					pmp_mt_auth,
					pmp_nb_auth,
					pmp_nb_comm_pct,
					nvl(pmp_partner_id, pe_partner_id) pmp_partner_id,
					pmp_rn_auth,
					pmp_rn_comm_pct,
					pmp_writing_company,
					(case when pmp_partner_id is null then 1 else 0 end) no_agreement_count
				FROM
					bi_fact_partner_mgt_agreement ma,
					bi_dim_partner_entity pe
				where
					pe.pe_partner_id = pmp_partner_id(+)
				and
					pe.pe_partner_type in ('Agent', 'Wholesale Agent')
				and pmp_partner_id is null
	    </SQL>
    </View>
	
    <DimensionUsage source="Dim_Broker" name="Broker" foreignKey="PMP_PARTNER_ID" highCardinality="false">
    </DimensionUsage>


	<Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="PMP_AGREEMENT_ID" name="Agreement Effective Date" caption="Agreement Effective Date">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="PMP_AGREEMENT_ID">
        <View alias="vw_aggreement_effective_dt">
          <SQL dialect="generic">    
			   SELECT
			          PMP_AGREEMENT_ID,
			          EXTRACT(YEAR FROM PMP_AGR_EFF_DATE)       td_year,
			          to_number(to_char(PMP_AGR_EFF_DATE, 'Q')) td_quarter,
			          'Q' || to_char(PMP_AGR_EFF_DATE, 'Q')     td_quarter_name,
			          EXTRACT(MONTH FROM PMP_AGR_EFF_DATE)      td_month,
			          to_char(PMP_AGR_EFF_DATE, 'Mon')          td_month_name,
			          to_char(PMP_AGR_EFF_DATE,'WW')            td_week,
			          EXTRACT(DAY FROM PMP_AGR_EFF_DATE)        td_day,
			          PMP_AGR_EFF_DATE                          td_date
			  FROM
			          BI_FACT_PARTNER_MGT_AGREEMENT  			   
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Effective Date Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Effective Date Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Effective Date Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Effective Date Week" description="Week of the Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Effective Date Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Effective Date" description="Created On Date">
      </Level>
      </Hierarchy>
    </Dimension>
		


	<Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="PMP_AGREEMENT_ID" name="Agreement Expiration Date" caption="Agreement Expiration Date">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="PMP_AGREEMENT_ID">
        <View alias="vw_agreement_expiration_dt">
          <SQL dialect="generic">    
			   SELECT
			          PMP_AGREEMENT_ID,
			          EXTRACT(YEAR FROM PMP_AGR_EXP_DATE)       td_year,
			          to_number(to_char(PMP_AGR_EXP_DATE, 'Q')) td_quarter,
			          'Q' || to_char(PMP_AGR_EXP_DATE, 'Q')     td_quarter_name,
			          EXTRACT(MONTH FROM PMP_AGR_EXP_DATE)      td_month,
			          to_char(PMP_AGR_EXP_DATE, 'Mon')          td_month_name,
			          to_char(PMP_AGR_EXP_DATE,'WW')            td_week,
			          EXTRACT(DAY FROM PMP_AGR_EXP_DATE)        td_day,
			          PMP_AGR_EXP_DATE                          td_date
			  FROM
			          BI_FACT_PARTNER_MGT_AGREEMENT  			   
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Expiration Date Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Expiration Date Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Expiration Date Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Expiration Date Week" description="Week of the Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Expiration Date Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Expiration Date" description="Created On Date">
      </Level>
      </Hierarchy>
    </Dimension>
		


	<Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="PMP_AGREEMENT_ID" name="Agreement Created Date" caption="Agreement Created Date">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="PMP_AGREEMENT_ID">
        <View alias="vw_agreement_created_dt">
          <SQL dialect="generic">    
			   SELECT
			          PML_ID,
			          EXTRACT(YEAR FROM PMP_AGR_CREATE_DATE)       td_year,
			          to_number(to_char(PMP_AGR_CREATE_DATE, 'Q')) td_quarter,
			          'Q' || to_char(PMP_AGR_CREATE_DATE, 'Q')     td_quarter_name,
			          EXTRACT(MONTH FROM PMP_AGR_CREATE_DATE)      td_month,
			          to_char(PMP_AGR_CREATE_DATE, 'Mon')          td_month_name,
			          to_char(PMP_AGR_CREATE_DATE,'WW')            td_week,
			          EXTRACT(DAY FROM PMP_AGR_CREATE_DATE)        td_day,
			          PMP_AGR_CREATE_DATE                          td_date
			  FROM
			          BI_FACT_PARTNER_MGT_AGREEMENT  			   
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Created Date Year" description="Created Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Created Date Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Created Date Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Created Date Week" description="Week of the Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Created Date Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Created Date" description="Created On Date">
      </Level>
      </Hierarchy>
    </Dimension>
		


    <Dimension type="StandardDimension" highCardinality="false" name="Agency_Jurisdiction" caption="Agency Jurisdiction">
      <Hierarchy hasAll="true">
        <Level name="Agency Jurisdiction" column="PMP_AGENCY_JURISDICTION" nameColumn="PMP_AGENCY_JURISDICTION" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="The Jurisdiction where the Agency is registered">
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension type="StandardDimension" highCardinality="false" name="Agreement_Jurisdiction" caption="Agreement Jurisdiction">
      <Hierarchy hasAll="true">
        <Level name="Agreement Jurisdiction" column="PMP_AGR_JURISDICTION" nameColumn="PMP_AGR_JURISDICTION" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="The Jurisdiction where the agreement was registered for">
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension type="StandardDimension" highCardinality="false" name="Agreement_LOB" caption="Line of Business">
      <Hierarchy hasAll="true">
        <Level name="Agreement LOB" caption="Line of Business" column="PMP_LINE_OF_BUSINESS" nameColumn="PMP_LINE_OF_BUSINESS" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="The Line of Business for which the agreement was registered">
        </Level>
      </Hierarchy>
    </Dimension>

    <Dimension type="StandardDimension" highCardinality="false" name="Agreement_Status" caption="Agreement Status">
      <Hierarchy hasAll="true">
        <Level name="Agreement Status" column="PMP_AGR_STATUS" nameColumn="PMP_AGR_STATUS" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Current status of the agreement">
        </Level>
      </Hierarchy>
    </Dimension>


    <Measure name="Agreement_Count" column="PMP_AGREEMENT_ID" datatype="Integer" formatString="#,###" aggregator="count" caption="Agreements Count" description="Total number of Agency Agreements">
    </Measure>
    <Measure name="No_Agreement_Count" column="NO_AGREEMENT_COUNT" datatype="Integer" formatString="#,###" aggregator="sum" caption="No Agreements Count" description="No Agreements">
    </Measure>
    
</Cube>
 
   <Cube name="ASSET_ANALYSIS_SUMMARY_HOME" caption="Asset Analysis - House" visible="true" cache="true" enabled="true">
    <View alias="vw_asset_house_analysis_summary">
        <SQL dialect="generic">    
		select
			pod_policy_id,
			pe_partner_id,
			clt_effective_date,
			clt_premium_written,
			clt_id,
			clt_earned_amt,
			clt_transaction_type_name,
			co_coverage_id,
			bd_total_building_area,
			bd_number_of_floors,
			bd_roof_type,
			bd_construction_type,
			cl.total_incurred_amt,
			bd_address_id,
			trans_order,
			trans_rn
		from
			(select
				pod_policy_id,
				pe_partner_id,
				clt_effective_date,
				clt_premium_written,
				clt_id,
				clt_earned_amt,
				clt_transaction_type_name,
				co_coverage_id,
				bd_total_building_area,
				bd_number_of_floors,
				bd_roof_type,
				bd_construction_type,
				bd_address_id,
				trans_order,
				row_number() over (partition by pod_policy_id, trans_order order by pt_eff_dt desc) trans_rn
			from
			    (Select
					clt.pod_policy_id,
					clt.pe_partner_id,
					clt.clt_effective_date,
					clt.clt_premium_written,
					clt.clt_earned_amt,
					clt.clt_id,
					clt.clt_transaction_type_name,
					clt.co_coverage_id,
					bd.bd_total_building_area,
					bd.bd_number_of_floors,
					bd.bd_roof_type,
					bd.bd_construction_type,
					bd.bd_address_id,
					greatest(ptd.pt_eff_dt, ptd.pt_processed_dt) pt_eff_dt,
					-- 9, 8, 4 New Business, Renewal, Endorsement 
					(case when ptd.pt_type_id in (9, 8, 4) and greatest(ptd.pt_eff_dt, ptd.pt_processed_dt) &lt;= trunc(sysdate) then 1
						   when ptd.pt_type_id in (9, 8, 4) and greatest(ptd.pt_eff_dt, ptd.pt_processed_dt) &gt; trunc(sysdate) then -1
						   else 3 end) trans_order
				from
					bi_fact_coverage_level_trx clt,
					bi_dim_covered_item        ci,
					bi_dim_building_detail     bd,
					bi_fact_policy_trx_detail ptd
				where
					clt.ci_item_id = ci.ci_item_id
				and
					ci.ci_item_id = bd.bd_building_id
				and
					clt.pt_policy_transaction_id = ptd.pt_id
				and
					clt.clt_effective_date >= add_months(trunc(sysdate), -12)
				and
					bd.bd_building_type = 'Home')) ha,
			(Select
				sc_policy_id,
				sum(sc_total_incurred_amt) total_incurred_amt
			from
				bi_fact_oc_subclaim_detail
			group by sc_policy_id) cl
		where
			ha.pod_policy_id = cl.sc_policy_id(+)
		and
			(trans_rn = 1 and trans_order != -1)
	    </SQL>
    </View>
    
    <DimensionUsage source="Dim_Broker" name="Broker" foreignKey="PE_PARTNER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Policy" name="Policy" foreignKey="POD_POLICY_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Dim_Address" name="Address" caption="Address" visible="true" foreignKey="BD_ADDRESS_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Dim_Coverage" name="Coverage Name" caption="Coverage Name" visible="true" foreignKey="CO_COVERAGE_ID" highCardinality="false">
    </DimensionUsage>
	
	<Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="CLT_ID" name="Effective Date" caption="Effective Date">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="CLT_ID">
        <View alias="vw_trx_effective_dt">
          <SQL dialect="generic">    
			   SELECT
			   CLT_ID,
			   EXTRACT(YEAR FROM CLT_EFFECTIVE_DATE)       td_year,
			   to_number(to_char(CLT_EFFECTIVE_DATE, 'Q')) td_quarter,
			   'Q' || to_char(CLT_EFFECTIVE_DATE, 'Q')     td_quarter_name,
			   EXTRACT(MONTH FROM CLT_EFFECTIVE_DATE)      td_month,
			   to_char(CLT_EFFECTIVE_DATE, 'Mon')          td_month_name,
			   to_char(CLT_EFFECTIVE_DATE,'WW')            td_week,
			   EXTRACT(DAY FROM CLT_EFFECTIVE_DATE)        td_day,
			   CLT_EFFECTIVE_DATE                          td_date
			  FROM
			   BI_FACT_COVERAGE_LEVEL_TRX  			   
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Effective Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Effective Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Effective Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Effective Week" description="Week of the Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Effective Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Effective Date" description="Created On Date">
      </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension type="StandardDimension" highCardinality="false" name="Transaction" caption="Transaction">
      <Hierarchy hasAll="true">
        <Level name="Coverage_Transaction_Name" column="CLT_TRANSACTION_TYPE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Transaction">
        </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension type="StandardDimension" highCardinality="false" name="House_Area" caption="House Area">
      <Hierarchy hasAll="true">
        <Level name="SQFT" column="BD_TOTAL_BUILDING_AREA" type="Numeric" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Square Feet">
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" highCardinality="false" name="House_No_of_Floors" caption="Number of Floors">
      <Hierarchy hasAll="true">
        <Level name="Number of Floors" column="BD_NUMBER_OF_FLOORS" type="Numeric" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="House Number of Floors">
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" highCardinality="false" name="House_Roof_Type" caption="House Roof">
      <Hierarchy hasAll="true">
        <Level name="Roof Type" column="BD_ROOF_TYPE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="House Roof">
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" highCardinality="false" name="House_Construction_type" caption="House Construction Type">
      <Hierarchy hasAll="true">
        <Level name="Class" column="BD_CONSTRUCTION_TYPE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="House Construction Type">
        </Level>
      </Hierarchy>
    </Dimension>
	

    <Measure name="Total_Premium" column="CLT_PREMIUM_WRITTEN" datatype="Numeric" formatString="$#,###" aggregator="sum" caption="Total Premium" description="Total Premium">
    </Measure>
	<Measure name="Total_Earned_Premium" column="CLT_EARNED_AMT" datatype="Numeric" formatString="$#,###" aggregator="sum" caption="Total Earned Premium" description="Total Earned Premium">
    </Measure>
	<Measure name="Total_Incurred_Loss" column="TOTAL_INCURRED_AMT" datatype="Numeric" formatString="$#,###" aggregator="sum" caption="Total Incurred Loss" description="Total Incurred Loss">
    </Measure>
	<Measure name="Total_Policies" column="POD_POLICY_ID" datatype="Numeric" formatString="#,###" aggregator="distinct-count" caption="Total Policies" description="Total Policies">
    </Measure>
	
	<CalculatedMember name="Loss_Ratio" formatString="###.##" visible="false" caption="Loss Ratio" description="Loss Ratio" dimension="Measures">
      <Formula>
	 <![CDATA[IIf( [Measures].[Total_Incurred_Loss] = 0, 0, ([Measures].[Total_Incurred_Loss]/[Measures].[Total_Earned_Premium]) )]]>
      </Formula>
    </CalculatedMember>  
  </Cube>   
  
  <Cube name="ASSET_ANALYSIS_SUMMARY_BUILDING" caption="Asset Analysis - Building" visible="true" cache="true" enabled="true">
    <View alias="vw_asset_bldg_analysis_summary">
        <SQL dialect="generic">    
		select
			pod_policy_id,
			pe_partner_id,
			clt_effective_date,
			clt_premium_written,
			clt_id,
			clt_earned_amt,
			clt_transaction_type_name,
			co_coverage_id,
			bd_total_building_area,
			bd_number_of_floors,
			bd_roof_type,
			bd_construction_type,
			cl.total_incurred_amt,
			bd_address_id,
			trans_order,
			trans_rn
		from
			(select
				pod_policy_id,
				pe_partner_id,
				clt_effective_date,
				clt_premium_written,
				clt_id,
				clt_earned_amt,
				clt_transaction_type_name,
				co_coverage_id,
				bd_total_building_area,
				bd_number_of_floors,
				bd_roof_type,
				bd_construction_type,
				bd_address_id,
				trans_order,
				row_number() over (partition by pod_policy_id, trans_order order by pt_eff_dt desc) trans_rn
			  from
				(Select
					clt.pod_policy_id,
					clt.pe_partner_id,
					clt.clt_effective_date,
					clt.clt_premium_written,
					clt.clt_earned_amt,
					clt.clt_id,
					clt.clt_transaction_type_name,
					clt.co_coverage_id,
					bd.bd_total_building_area,
					bd.bd_number_of_floors,
					bd.bd_roof_type,
					bd.bd_construction_type,
					bd.bd_address_id,
					greatest(ptd.pt_eff_dt, ptd.pt_processed_dt) pt_eff_dt,
					-- 9, 8, 4 New Business, Renewal, Endorsement 
					(case when ptd.pt_type_id in (9, 8, 4) and greatest(ptd.pt_eff_dt, ptd.pt_processed_dt) &lt;= trunc(sysdate) then 1
						 when ptd.pt_type_id in (9, 8, 4) and greatest(ptd.pt_eff_dt, ptd.pt_processed_dt) &gt; trunc(sysdate) then -1
					 else 3 end) trans_order
				from
					bi_fact_coverage_level_trx clt,
					bi_dim_covered_item        ci,
					bi_dim_building_detail     bd,
					bi_fact_policy_trx_detail ptd
				where
					clt.ci_item_id = ci.ci_item_id
				and
					ci.ci_item_id = bd.bd_building_id
				and
					clt.pt_policy_transaction_id = ptd.pt_id
				and
					clt.clt_effective_date >= add_months(trunc(sysdate), -12)
				and
					bd.bd_building_type = 'Building')) ba,
		   (Select
			   sc_policy_id,
			   sum(sc_total_incurred_amt) total_incurred_amt
		    from
			   bi_fact_oc_subclaim_detail
		    group by sc_policy_id) cl
		where
			ba.pod_policy_id = cl.sc_policy_id(+)
		and
			(trans_rn = 1 and trans_order != -1)
	    </SQL>
    </View>
    
    <DimensionUsage source="Dim_Broker" name="Broker" foreignKey="PE_PARTNER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Policy" name="Policy" foreignKey="POD_POLICY_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Address" name="Address" caption="Address" visible="true" foreignKey="BD_ADDRESS_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Dim_Coverage" name="Coverage Name" caption="Coverage Name" visible="true" foreignKey="CO_COVERAGE_ID" highCardinality="false">
    </DimensionUsage>

	<Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="CLT_ID" name="Effective Date" caption="Effective Date">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="CLT_ID">
        <View alias="vw_trx_effective_dt">
          <SQL dialect="generic">    
			   SELECT
			   CLT_ID,
			   EXTRACT(YEAR FROM CLT_EFFECTIVE_DATE)       td_year,
			   to_number(to_char(CLT_EFFECTIVE_DATE, 'Q')) td_quarter,
			   'Q' || to_char(CLT_EFFECTIVE_DATE, 'Q')     td_quarter_name,
			   EXTRACT(MONTH FROM CLT_EFFECTIVE_DATE)      td_month,
			   to_char(CLT_EFFECTIVE_DATE, 'Mon')          td_month_name,
			   to_char(CLT_EFFECTIVE_DATE,'WW')            td_week,
			   EXTRACT(DAY FROM CLT_EFFECTIVE_DATE)        td_day,
			   CLT_EFFECTIVE_DATE                          td_date
			  FROM
			   BI_FACT_COVERAGE_LEVEL_TRX  			   
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Effective Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Effective Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Effective Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Effective Week" description="Week of the Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Effective Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Effective Date" description="Created On Date">
      </Level>
      </Hierarchy>
    </Dimension>
	
		<Dimension type="StandardDimension" highCardinality="false" name="Transaction" caption="Transaction">
      <Hierarchy hasAll="true">
        <Level name="Coverage_Transaction_Name" column="CLT_TRANSACTION_TYPE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Transaction">
        </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension type="StandardDimension" highCardinality="false" name="Building_Area" caption="Building Area">
      <Hierarchy hasAll="true">
        <Level name="SQFT" column="BD_TOTAL_BUILDING_AREA" type="Numeric" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Square Feet">
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" highCardinality="false" name="Building_No_of_Floors" caption="Number of Floors">
      <Hierarchy hasAll="true">
        <Level name="Number of Floors" column="BD_NUMBER_OF_FLOORS" type="Numeric" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Building Number of Floors">
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" highCardinality="false" name="Building_Roof_Type" caption="Building Roof">
      <Hierarchy hasAll="true">
        <Level name="Roof Type" column="BD_ROOF_TYPE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Building Roof">
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" highCardinality="false" name="Building_Construction_type" caption="Building Construction Type">
      <Hierarchy hasAll="true">
        <Level name="Class" column="BD_CONSTRUCTION_TYPE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Building Construction Type">
        </Level>
      </Hierarchy>
    </Dimension>
	

    <Measure name="Total_Premium" column="CLT_PREMIUM_WRITTEN" datatype="Numeric" formatString="$#,###" aggregator="sum" caption="Total Premium" description="Total Premium">
    </Measure>
	<Measure name="Total_Earned_Premium" column="CLT_EARNED_AMT" datatype="Numeric" formatString="$#,###" aggregator="sum" caption="Total Earned Premium" description="Total Earned Premium">
    </Measure>
	<Measure name="Total_Incurred_Loss" column="TOTAL_INCURRED_AMT" datatype="Numeric" formatString="$#,###" aggregator="sum" caption="Total Incurred Loss" description="Total Incurred Loss">
    </Measure>
	<Measure name="Total_Policies" column="POD_POLICY_ID" datatype="Numeric" formatString="#,###" aggregator="distinct-count" caption="Total Policies" description="Total Policies">
    </Measure>
	
	<CalculatedMember name="Loss_Ratio" formatString="###.##" visible="false" caption="Loss Ratio" description="Loss Ratio" dimension="Measures">
      <Formula>
	 <![CDATA[IIf( [Measures].[Total_Incurred_Loss] = 0, 0, ([Measures].[Total_Incurred_Loss]/[Measures].[Total_Earned_Premium]) )]]>
      </Formula>
    </CalculatedMember>  
  </Cube>   

  <Cube name="EXPOSURE_ANALYSIS_SUMMARY" caption="Exposure Analysis Summary" visible="true" cache="true" enabled="true">
    <View alias="vw_exposure_analysis_summary">
        <SQL dialect="generic">   
	     Select
			pt.pt_id,
			pd.pod_policy_id,
			pd.cd_customer_id,
			pd.pod_policy_product_name,
			pd.pe_partner_id,
			pd.pod_primary_risk_state,
			pt.pt_processed_dt,
			pt.pt_premium_after_amt,
			pt.pt_premium_change_amt,
			pt.ud_underwriter_id,
			pt.pe_writing_company_id,
			pt.pt_program_type,
			pt.pt_total_cost_change_amt,
			cd.co_coverage_type,
			cd.co_coverage_code,
			cd.co_coverage_name,
			cd.co_charge_type,
			ca.ca_code,
			ca.ca_name,
			ca.ca_type_code,
			ca.ca_type_name,
			nvl(ca.ca_amt_number, 0) exposure_amount,
			ci.ci_item_id,
			ct.clt_premium_written,
			ci.ci_covered_item_asset_type,
			ci.ci_covered_item_asset_name,
			vd.vd_vehicle_id,
			bd.bd_building_id,
			(case when vd.vd_vehicle_id is not null then vd.vd_vehicle_id else null end) vehicle_count,
			(case when bd.bd_building_id is not null and bd.bd_building_type = 'Building' then bd.bd_building_id else null end) building_count,
			(case when bd.bd_building_id is not null and bd.bd_building_type = 'Home' then bd.bd_building_id else null end) house_count,
			(case when ci.ci_covered_item_asset_type = 'Customer' then ci.ci_item_id else null end) entity_count,
			nvl(bd.bd_number_of_floors, 0) bd_number_of_floors,
			bd.bd_building_type
		from
			bi_fact_policy_trx_detail pt,
			bi_fact_coverage_level_trx ct,
			bi_fact_coverage_attribute ca,
			bi_dim_policy_detail pd,
			bi_dim_coverage_detail cd,
			bi_dim_covered_item ci,
			bi_dim_vehicle_detail vd,
			bi_dim_building_detail bd
		where
			pt.pt_policy_id = ct.pod_policy_id
		and
			pt.pt_policy_id = pd.pod_policy_id
		and
			pt.pt_id = ca.pt_id
		and
			ct.co_coverage_id = ca.co_coverage_id
		and
			ct.clt_id = ca.clt_id
		and
			ct.co_coverage_id = cd.co_coverage_id
		and
			ct.ci_item_id = ci.ci_item_id
		and
			ct.ci_item_id = vd.vd_vehicle_id(+)
		and
			ct.ci_item_id = bd.bd_building_id(+)
		and
			pt.pt_type_id in (9, 8)
		and
			pd.pod_policy_eff_date >= add_months(trunc(sysdate), -12)
	    </SQL>
    </View>
    
    <DimensionUsage source="Dim_Broker" name="Broker" foreignKey="PE_PARTNER_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Policy" name="Policy" foreignKey="POD_POLICY_ID" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Dim_Underwriter" name="Underwriter" foreignKey="UD_UNDERWRITER_ID" highCardinality="false">
    </DimensionUsage>
	
	<Dimension type="StandardDimension" highCardinality="false" name="Coverage_Type" caption="Coverage Type">
      <Hierarchy hasAll="true">
        <Level name="Type" column="CO_COVERAGE_TYPE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Coverage Type">
        </Level>
      </Hierarchy>
    </Dimension>

	<Dimension type="StandardDimension" highCardinality="false" name="Coverage" caption="Coverage">
      <Hierarchy hasAll="true">
        <Level name="Coverage_Name" column="CO_COVERAGE_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Coverage Name">
        </Level>
      </Hierarchy>
    </Dimension>
    
	<Dimension type="StandardDimension" highCardinality="false" name="Line_of_Business" caption="Line of Business">
      <Hierarchy hasAll="true">
        <Level name="Product" column="POD_POLICY_PRODUCT_NAME" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="Product">
        </Level>
      </Hierarchy>
    </Dimension>
    
	<Dimension type="StandardDimension" highCardinality="false" name="State" caption="State">
      <Hierarchy hasAll="true">
        <Level name="State" column="POD_PRIMARY_RISK_STATE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" description="State">
        </Level>
      </Hierarchy>
    </Dimension>
    
    <Measure name="Total_Vehicle_Count" column="VEHICLE_COUNT" datatype="Numeric" formatString="#,###" aggregator="distinct-count" caption="Vehicle Count" description="Total Vehicle Count">
    </Measure>
    
    <Measure name="Total_Building_Count" column="BUILDING_COUNT" datatype="Numeric" formatString="#,###" aggregator="distinct-count" caption="Building Count" description="Total Building Count">
    </Measure>
    
    <Measure name="Total_House_Count" column="HOUSE_COUNT" datatype="Numeric" formatString="#,###" aggregator="distinct-count" caption="House Count" description="Total House Count">
    </Measure>

    <Measure name="Total_Entity_Count" column="ENTITY_COUNT" datatype="Numeric" formatString="#,###" aggregator="distinct-count" caption="Entity Count" description="Total Entity Count">
    </Measure>
    
	<Measure name="Exposure_Amount" column="EXPOSURE_AMOUNT" datatype="Numeric" formatString="$#,###" aggregator="sum" caption="Exposure Amount" description="Exposure Amount">
    </Measure>
 
  </Cube>
  
    <Cube name="PARTNER_RANK_DETAILS" caption="Partner Rank" visible="true" cache="true" enabled="true">
    <View alias="vw_partner_rank_details">
        <SQL dialect="generic">   
         select  PARTNER_ID, PENDING_CANCEL_POLICY_COUNT, CLAIM_COUNT, TOTAL_INCURRED_AMT, PARTNER_RANK, 
         1 COUNTER,PARTNER_CLAIM_COUNT_RANK,PARTNER_PENDCANCEL_COUNT_RANK,PARTNER_TOTAL_INCURRED_RANK,
         1 PARTNER_CLAIM_COUNTER,
         1 PARTNER_PENDCANCEL_COUNTER,
         1 PARTNER_TOTAL_INCURRED_COUNTER
         
         from (with t1 as
         (select BI_FACT_POLICY_TRX_DETAIL.PE_PARTNER_ID,
           count(distinct BI_DIM_POLICY_DETAIL.POD_POLICY_NUMBER) as PENDING_CANCEL_POLICY_COUNT
          from BI_FACT_POLICY_TRX_DETAIL, BI_DIM_POLICY_DETAIL
           where PT_TYPE_ID IN (4212)
           and BI_DIM_POLICY_DETAIL.pod_policy_status = 'PendingCancel'
           and BI_DIM_POLICY_DETAIL.POD_POLICY_ID = BI_FACT_POLICY_TRX_DETAIL.PT_POLICY_ID
           and BI_FACT_POLICY_TRX_DETAIL.PT_EFF_DT  >= add_months(trunc(sysdate), -12)
           group by BI_FACT_POLICY_TRX_DETAIL.PE_PARTNER_ID),

        t2 as
         (select cd.cd_policy_agency_id,
           count(distinct cd.cd_claim_id) as CLAIM_COUNT,
           sum(cd.cd_total_incurred_amt) as TOTAL_INCURRED_AMT
          from bi_fact_oc_claim_detail cd, bi_dim_oc_incident_detail id
           where cd.cd_incident_id = id.id_incident_id
           and (cd.cd_claim_creation_dt >= add_months(trunc(sysdate), -12) or
           cd.cd_claim_status_id != 57546)
           group by cd.cd_policy_agency_id),   
         t3 as
         (select p.pe_partner_id from bi_dim_partner_entity p)

        select t3.pe_partner_id as PARTNER_ID,
           t1.PENDING_CANCEL_POLICY_COUNT,
           t2.CLAIM_COUNT,
           t2.TOTAL_INCURRED_AMT,
           DENSE_RANK() OVER(ORDER BY (NVL(t2.CLAIM_COUNT,0) + NVL(t2.TOTAL_INCURRED_AMT,0) + NVL(t1.PENDING_CANCEL_POLICY_COUNT,0)) asc) PARTNER_RANK,
           DENSE_RANK() OVER(ORDER BY NVL(t2.CLAIM_COUNT,0) asc) PARTNER_CLAIM_COUNT_RANK,
           DENSE_RANK() OVER(ORDER BY NVL(t2.TOTAL_INCURRED_AMT,0) asc) PARTNER_TOTAL_INCURRED_RANK,
           DENSE_RANK() OVER(ORDER BY NVL(t1.PENDING_CANCEL_POLICY_COUNT,0) asc) PARTNER_PENDCANCEL_COUNT_RANK
         
         from t3
          full outer join t2
          on (t3.PE_PARTNER_ID = t2.cd_policy_agency_id)
          full outer join t1
          on (t3.PE_PARTNER_ID = t1.PE_PARTNER_ID) )
          where PARTNER_ID = %OS_PARTNER_ID%
          
          UNION 
              select  PARTNER_ID, PENDING_CANCEL_POLICY_COUNT, CLAIM_COUNT, TOTAL_INCURRED_AMT, PARTNER_RANK,
          1 + PARTNER_RANK as COUNTER,PARTNER_CLAIM_COUNT_RANK,PARTNER_PENDCANCEL_COUNT_RANK,PARTNER_TOTAL_INCURRED_RANK,
         1 + PARTNER_CLAIM_COUNT_RANK as PARTNER_CLAIM_COUNTER,
         1 + PARTNER_PENDCANCEL_COUNT_RANK as PARTNER_PENDCANCEL_COUNTER,
         1 + PARTNER_TOTAL_INCURRED_RANK as PARTNER_TOTAL_INCURRED_COUNTER
         from (with t1 as
         (select BI_FACT_POLICY_TRX_DETAIL.PE_PARTNER_ID,
           count(distinct BI_DIM_POLICY_DETAIL.POD_POLICY_NUMBER) as PENDING_CANCEL_POLICY_COUNT
          from BI_FACT_POLICY_TRX_DETAIL, BI_DIM_POLICY_DETAIL
           where PT_TYPE_ID IN (4212)
           and BI_DIM_POLICY_DETAIL.pod_policy_status = 'PendingCancel'
           and BI_DIM_POLICY_DETAIL.POD_POLICY_ID = BI_FACT_POLICY_TRX_DETAIL.PT_POLICY_ID
           and BI_FACT_POLICY_TRX_DETAIL.PT_EFF_DT  >= add_months(trunc(sysdate), -12)
           group by BI_FACT_POLICY_TRX_DETAIL.PE_PARTNER_ID),

        t2 as
         (select cd.cd_policy_agency_id,
           count(distinct cd.cd_claim_id) as CLAIM_COUNT,
           sum(cd.cd_total_incurred_amt) as TOTAL_INCURRED_AMT
          from bi_fact_oc_claim_detail cd, bi_dim_oc_incident_detail id
           where cd.cd_incident_id = id.id_incident_id
           and (cd.cd_claim_creation_dt >= add_months(trunc(sysdate), -12) or
           cd.cd_claim_status_id != 57546)
           group by cd.cd_policy_agency_id),
       
         t3 as
         (select p.pe_partner_id from bi_dim_partner_entity p)

        select t3.pe_partner_id as PARTNER_ID,
           t1.PENDING_CANCEL_POLICY_COUNT,
           t2.CLAIM_COUNT,
           t2.TOTAL_INCURRED_AMT,
           DENSE_RANK() OVER(ORDER BY (NVL(t2.CLAIM_COUNT,0) + NVL(t2.TOTAL_INCURRED_AMT,0) + NVL(t1.PENDING_CANCEL_POLICY_COUNT,0)) asc) PARTNER_RANK,
           DENSE_RANK() OVER(ORDER BY NVL(t2.CLAIM_COUNT,0) asc) PARTNER_CLAIM_COUNT_RANK,
           DENSE_RANK() OVER(ORDER BY NVL(t2.TOTAL_INCURRED_AMT,0) asc) PARTNER_TOTAL_INCURRED_RANK,
           DENSE_RANK() OVER(ORDER BY NVL(t1.PENDING_CANCEL_POLICY_COUNT,0) asc) PARTNER_PENDCANCEL_COUNT_RANK
          from t3
          full outer join t2
          on (t3.PE_PARTNER_ID = t2.cd_policy_agency_id)
          full outer join t1
          on (t3.PE_PARTNER_ID = t1.PE_PARTNER_ID) )
          where (%OS_PARTNER_ID% is null OR %OS_PARTNER_ID% = 118 OR PARTNER_ID != %OS_PARTNER_ID%)
          ORDER BY COUNTER
          
	    </SQL>
    </View>
    
    <DimensionUsage source="Dim_Broker" name="Broker" foreignKey="PARTNER_ID" highCardinality="false">
    </DimensionUsage>
    
    
    <Measure name="PendingCancel_Count" column="PENDING_CANCEL_POLICY_COUNT" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Pending Cancel Count" description="Pending Cancel Count">
    </Measure>
    
    <Measure name="Claim_Count" column="CLAIM_COUNT" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Claim Count" description="Claim Count">
    </Measure>
    
    <Measure name="Total_Incurred_amt" column="TOTAL_INCURRED_AMT" datatype="Numeric" formatString="$#,###" aggregator="sum" caption="Total Incurred Amount" description="Total Incurred Amount">
    </Measure>

    <Measure name="Partner_rank" column="PARTNER_RANK" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Partner Rank" description="Partner Rank">
    </Measure>
	
	 <Measure name="Partner_rank_counter" column="COUNTER" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Partner Rank Counter" description="Counter">
    </Measure>
	
	 <Measure name="Partner_claim_count_rank" column="PARTNER_CLAIM_COUNT_RANK" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Partner Claim Count Rank" description="Partner Rank based on Claim Count">
    </Measure>
	
	 <Measure name="Partner_claim_rank_counter" column="PARTNER_CLAIM_COUNTER" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Partner Claim Count Rank Counter" description="Claim Count Counter">
    </Measure>
	
	 <Measure name="Partner_pendcancel_rank" column="PARTNER_PENDCANCEL_COUNT_RANK" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Partner Pending Cancel Rank" description="Partner Rank based on Pending Cancel Policies">
    </Measure>
	
	 <Measure name="Partner_pendcancel_rank_counter" column="PARTNER_PENDCANCEL_COUNTER" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Partner Pending Cancel Rank Counter" description="Pending Cancel Rank Counter">
    </Measure>
	
	 <Measure name="Partner_totalincurred_rank" column="PARTNER_TOTAL_INCURRED_RANK" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Partner Total Incurred Rank" description="Partner Rank Based on Total Incurred Amount">
    </Measure>
	
	 <Measure name="Partner_totalincurred_rank_counter" column="PARTNER_TOTAL_INCURRED_RANK" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Partner Total Incurred Rank Counter" description="Counter">
    </Measure>
 
  </Cube>

  <Cube name="PARTNER_TASKS" caption="Partner Tasks" visible="true" cache="true" enabled="true">
    <Table name="BI_FACT_TASK_DETAIL">
	<SQL dialect="generic">
         <![CDATA[(((%OS_PARTNER_ID% is null OR %OS_PARTNER_ID% = 118 AND BI_FACT_TASK_DETAIL.PE_PARTNER_ID = %OS_PARTNER_ID%)
		  AND ( %OS_USER_ID% is null OR BI_FACT_TASK_DETAIL.UD_ASSIGNED_USER_ID = %OS_USER_ID%
			  OR BI_FACT_TASK_DETAIL.UD_ASSIGNED_USER_ID IN (select UD_USER_ID from BI_DIM_USER_DETAIL WHERE UD_REPORTS_TO_USER = %OS_USER_ID%))
		  OR 
		  (%OS_PARTNER_ID% is null OR %OS_PARTNER_ID% != 118 AND BI_FACT_TASK_DETAIL.PE_PARTNER_ID = %OS_PARTNER_ID%))     
		AND (TD_CREATE_DT >= add_months(trunc(sysdate), -12) OR TD_STATUS_IND != 1)
		AND BI_FACT_TASK_DETAIL.UD_ASSIGNED_USER_ID IN (select UD_USER_ID from BI_DIM_USER_DETAIL WHERE ud_agency_code != 0))]]>           
      </SQL>
    </Table>
	
    <DimensionUsage source="Dim_Creator" name="Creator" visible="true" foreignKey="UD_CREATOR_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Dim_Assignee" name="Assignee" visible="true" foreignKey="UD_ASSIGNED_USER_ID" highCardinality="false">
    </DimensionUsage>
	<DimensionUsage source="Dim_Partner_Category" name="Partner Category" visible="true" foreignKey="PE_PARTNER_ID" highCardinality="false">
    </DimensionUsage>
	

    <Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="TD_TASK_ID" name="Time (Creation Date)" caption="Time (Creation Date)">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="TD_TASK_ID">
        <View alias="vw_td_create_dt">
          <SQL dialect="generic">    
		   SELECT
			 td_task_id,
			 EXTRACT(YEAR FROM td_create_dt)       td_year,
			 to_number(to_char(td_create_dt, 'Q')) td_quarter,
			 'Q' || to_char(td_create_dt, 'Q')     td_quarter_name,
			 EXTRACT(MONTH FROM td_create_dt)      td_month,
			 to_char(td_create_dt, 'Mon')          td_month_name,
			 to_char(TD_CREATE_DT,'WW')            td_week,			   
			 EXTRACT(DAY FROM td_create_dt)        td_day,
			 td_create_dt					    td_date
		  FROM
			 bi_fact_task_detail
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Creation Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Creation Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Creation Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Creation Week" description="Creation Week">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Creation Date" description="Creation Date">
      </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="TimeDimension" visible="true" highCardinality="false" foreignKey="TD_TASK_ID" name="Time (Completed Date)" caption="Time (Completed Date)">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Periods" primaryKey="TD_TASK_ID">
        <View alias="vw_td_completed_dt">
          <SQL dialect="generic">    
		   SELECT
			 td_task_id,
			 EXTRACT(YEAR FROM td_completed_dt)       td_year,
			 to_number(to_char(td_completed_dt, 'Q')) td_quarter,
			 'Q' || to_char(td_completed_dt, 'Q')     td_quarter_name,
			 EXTRACT(MONTH FROM td_completed_dt)      td_month,
			 to_char(td_completed_dt, 'Mon')          td_month_name,
			 to_char(TD_COMPLETED_DT,'WW')         td_week,			   
			 EXTRACT(DAY FROM td_completed_dt)        td_day,
			 td_completed_dt					      td_date
		  FROM
			 bi_fact_task_detail
	 </SQL>
        </View>
        <Level name="Year" visible="true" column="TD_YEAR" ordinalColumn="TD_YEAR" type="Numeric" uniqueMembers="true" levelType="TimeYears" hideMemberIf="Never" caption="Completed Year" description="Year">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy]</Annotation>
          </Annotations>
        </Level>
        <Level name="Quarter" visible="true" column="TD_QUARTER" nameColumn="TD_QUARTER_NAME" ordinalColumn="TD_QUARTER" type="Numeric" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never" caption="Completed Quarter" description="Name or number of the Quarter">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q]</Annotation>
          </Annotations>
        </Level>
        <Level name="Month" visible="true" column="TD_MONTH" nameColumn="TD_MONTH_NAME" ordinalColumn="TD_MONTH" type="Numeric" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never" caption="Completed Month" description="Name of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM]</Annotation>
          </Annotations>
        </Level>
		<Level name="Week" visible="true" column="TD_WEEK" ordinalColumn="TD_WEEK" type="Numeric" uniqueMembers="false" levelType="TimeWeeks" hideMemberIf="Never" caption="Completed Week" description="Completed Week">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww]</Annotation>
          </Annotations>
        </Level>
        <Level name="Day" visible="true" column="TD_DAY" type="Numeric" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Completed Day" description="Day of the month">
          <Annotations>
            <Annotation name="AnalyzerDateFormat">[yyyy].['Q'q].[MMM].[ww].[d]</Annotation>
          </Annotations>
        </Level>
	   <Level name="Date" visible="true" column="TD_DATE" ordinalColumn="TD_DATE" type="Date" uniqueMembers="true" levelType="TimeDays" hideMemberIf="Never" caption="Completed Date" description="Completed Date">
      </Level>
      </Hierarchy>
    </Dimension>
    
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Task Type" caption="Task Type">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Task Types">
        <Level name="Task Type" visible="true" column="TD_TASK_TYPE_DESC" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Task Type" description="Type of task. Useful if this is a system generated task">
        </Level>
        <Level name="Task Title" visible="true" column="TD_TASK_TITLE" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Task Title" description="Title of task. Useful if this is a system generated task">
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Overdue" caption="Overdue?">
      <Hierarchy visible="true" hasAll="true" allMemberName="All Complete and Incomplete">
        <Level name="Overdue" visible="true" column="TD_OVERDUE_IND" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Overdue" description="Is this Task overdue?">
          <KeyExpression>
            <SQL dialect="oracle">
              <![CDATA[case 
					when TD_OVERDUE_IND=1 then 'Yes'  
					when  TD_OVERDUE_IND=2 then 'No'  
					when  TD_OVERDUE_IND is null then 'No'  
					else 'No' end]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Internal Indicator" caption="Internal?">
      <Hierarchy visible="true" hasAll="true">
        <Level name="Internal" visible="true" column="TD_INTERNAL_IND" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Internal" description="Is the task being assigned internally ?">
          <KeyExpression>
            <SQL dialect="oracle">
              <![CDATA[case 
					when TD_INTERNAL_IND=1 then 'Yes'  
					when  TD_INTERNAL_IND=2 then 'No'  
					when  TD_INTERNAL_IND is null then 'No'  
					else 'No' end]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Task Status" caption="Task Status">
      <Hierarchy visible="true" hasAll="true">
        <Level name="Task Status" visible="true" column="TD_STATUS_IND" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Task Status" description="Status of the Task">
          <KeyExpression>
            <SQL dialect="oracle">
              <![CDATA[case 
					when TD_STATUS_IND=1 then 'Complete'  
					else 'Incomplete' end]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Task Rejection Reason" caption="Task Rejection Reason">
      <Hierarchy visible="true" hasAll="true">
        <Level name="Task Rejection Reason" visible="true" column="TD_POLICY_REJECTION_REASON" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Task Rejection reason" description="Rejection Reason for the Task">
        </Level>
      </Hierarchy>
    </Dimension>
    <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Task ID" caption="Task ID">
      <Hierarchy visible="true" hasAll="true">
        <Level name="Task ID" visible="true" column="TD_TASK_ID" type="Numeric" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" caption="Task ID" description="Task Id">
        </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension type="StandardDimension" highCardinality="false" name="Task_Age" caption="Task Age">
      <Hierarchy hasAll="true">
	   <Level name="Task_Age" visible="true" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never"  caption="Task Age" description="Task Age">
          <KeyExpression>
            <SQL dialect="oracle">
              <![CDATA[(case when (round(sysdate - TD_CREATE_DT, 0) < 0) or (round(sysdate - TD_CREATE_DT, 0) between 0 and 30)
               then '0-30 days'
             when (round(sysdate - TD_CREATE_DT, 0) between 31 and 60)
               then '31-60 days'
             when (round(sysdate - TD_CREATE_DT, 0) between 61 and 90)
               then '61-90 days'
             when (round(sysdate - TD_CREATE_DT, 0) > 90)
               then 'Above 90 days'
             else
               'Others'
           end)]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>
	
	<Dimension type="StandardDimension" highCardinality="false" name="Task_TAT" caption="Task Turn Around Time">
      <Hierarchy hasAll="true">
	   <Level name="Task_TAT" visible="true" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never"  caption="Task Turn Around Time" description="Task Turn Around Time">
          <KeyExpression>
            <SQL dialect="oracle">
              <![CDATA[(case when ((round(TD_COMPLETED_DT - TD_CREATE_DT, 0) < 0) or (round(TD_COMPLETED_DT - TD_CREATE_DT, 0) between 0 and 30))
						   then '0-30 days'
					   when round(TD_COMPLETED_DT - TD_CREATE_DT, 0) between 31 and 60
						   then '31-60 days'
					   when round(TD_COMPLETED_DT - TD_CREATE_DT, 0) between 61 and 90
						   then '61-90 days'
					   when round(TD_COMPLETED_DT - TD_CREATE_DT, 0) > 90
						   then 'Above 90 days'
					   else
						   'Others'
				   end)
				  ]]>
            </SQL>
          </KeyExpression>
        </Level>
      </Hierarchy>
    </Dimension>
	
    <Measure name="Total_Task_Count" column="TD_TASK_ID" datatype="Numeric" formatString="#,###" aggregator="count" caption="Total Task Count" description="Number of Tasks">
    </Measure>
    <Measure name="Open_Task_Count" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Open Task Count(Non-Overdue)" description="Number of Incomplete Tasks">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[decode(TD_STATUS_IND, 2, 1, 0)]]>
        </SQL>
      </MeasureExpression>
    </Measure>
    <Measure name="Completed_Task_Count" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Completed Task Count" description="Total of Completed Tasks">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[decode(TD_STATUS_IND, 1, 1, 0)]]>
        </SQL>
      </MeasureExpression>
    </Measure>
	<Measure name="Open_Overdue_Task_Count" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Open Task Count(Overdue)" description="Number of Incomplete Tasks">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[decode(TD_STATUS_IND, 42346, 1, 0)]]>
        </SQL>
      </MeasureExpression>
    </Measure>
    <Measure name="Overdue_Task_Count" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Overdue Task Count" description="Overdue Task Count">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[decode(TD_OVERDUE_IND, 1, 1, 0)]]>
        </SQL>
      </MeasureExpression>
    </Measure>
    <Measure name="On_Time_Task_Count" datatype="Numeric" formatString="#,###" aggregator="sum" caption="On Time Task Count" description="Tasks Done on or before the due date">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[case when TD_STATUS_IND = 1 and TD_COMPLETED_DT < TD_DUE_DT and TD_COMPLETED_DT != '01-JAN-1900' then 1 else 0 end]]>
        </SQL>
      </MeasureExpression>
    </Measure>
    <Measure name="Total_Completion_Time" datatype="Numeric" formatString="#,###" aggregator="sum" caption="Days to Complete Task" description="Total number of days to complete task">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[(case when TD_TIME_TO_COMPLETE_DAYS is null THEN 0 ELSE TD_TIME_TO_COMPLETE_DAYS END)]]>
        </SQL>
      </MeasureExpression>
    </Measure>
	<Measure name="Avg_TAT_Time" datatype="Numeric" formatString="#,###.00" aggregator="avg" caption="Average Task Turn Around Time" description="Average Task Turn Around Time">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[ case when TD_STATUS_IND = 1 THEN(round(TD_COMPLETED_DT - TD_CREATE_DT, 0)) ELSE null END]]>
        </SQL>
      </MeasureExpression>
    </Measure>
	
	<Measure name="Total_Open_Task_Count" datatype="Numeric" formatString="#,###" aggregator="count" caption="Open Task Count" description="Number of Incomplete Tasks">
      <MeasureExpression>
        <SQL dialect="oracle">
          <![CDATA[case when TD_STATUS_IND != 1 then TD_TASK_ID else null end]]>
        </SQL>
      </MeasureExpression>
    </Measure>
    
    <CalculatedMember name="Avg_Completion_Time" formatString="###.000" caption="Avg Time to Complete" description="Average time taken to complete (in business days)" dimension="Measures">
      <Formula>
        <![CDATA[IIf( [Measures].[Total_Task_Count] = 0, null, [Measures].[Total_Completion_Time] / [Measures].[Total_Task_Count] )]]>
      </Formula>
    </CalculatedMember>
    <CalculatedMember name="Percent_Completed_Tasks" formatString="###.0%" caption="% Complete" description="Completed Tasks Percent" dimension="Measures">
      <Formula>
        <![CDATA[IIf( ([Measures].[Task_Count] = 0 or [Measures].[Completed_Task_Count] = 0), null, [Measures].[Completed_Task_Count] / [Measures].[Task_Count])]]>
      </Formula>
    </CalculatedMember>
    <CalculatedMember name="Percent_Incomplete_Tasks" formatString="###.0%" caption="% Incomplete" description="Incomplete Tasks Percent" dimension="Measures">
      <Formula>
        <![CDATA[IIf( ([Measures].[Task_Count] = 0 or [Measures].[Open_Task_Count] = 0), null, [Measures].[Open_Task_Count] / [Measures].[Task_Count])]]>
      </Formula>
    </CalculatedMember>
    <CalculatedMember name="Percent_Overdue_Tasks" formatString="###.0%" caption="Overdue task %" description="Overdue Tasks Percent" dimension="Measures">
      <Formula>
        <![CDATA[IIf( ([Measures].[Open_Task_Count] = 0 or [Measures].[Overdue_Task_Count] = 0), null, [Measures].[Overdue_Task_Count] / [Measures].[Open_Task_Count])]]>
      </Formula>
    </CalculatedMember>

  </Cube>
  
<!-- Combination of CUSTOMER_SUMMARY, POLICY_SUMMARY -->
	
<VirtualCube name="VC_POLICY_CUSTOMER_SUMMARY_COMBINED">
	<CubeUsages>
	<CubeUsage cubeName="CUSTOMER_SUMMARY" ignoreUnrelatedDimensions="true"/>
	<CubeUsage cubeName="POLICY_SUMMARY"/>
	<CubeUsage cubeName="SUBMISSIONS_SUMMARY"/>
	</CubeUsages>
	<VirtualCubeDimension cubeName="CUSTOMER_SUMMARY" name="Customer"/>
	<VirtualCubeDimension cubeName="POLICY_SUMMARY" name="Policy_Number"/>
	<VirtualCubeDimension cubeName="SUBMISSIONS_SUMMARY" name="Quote"/>
	<VirtualCubeMeasure cubeName="CUSTOMER_SUMMARY" name="[Measures].[Total_Customers]"/>
	<VirtualCubeMeasure cubeName="POLICY_SUMMARY" name="[Measures].[Total_Policies]"/>
	<VirtualCubeMeasure cubeName="POLICY_SUMMARY" name="[Measures].[Total_Premium]"/>
	<VirtualCubeMeasure cubeName="SUBMISSIONS_SUMMARY" name="[Measures].[Bind_Rate]"/>

</VirtualCube>

<VirtualCube name="VC_POLICY_SUBMISSION_COMBINED">
	<CubeUsages>
	<CubeUsage cubeName="POLICY_SUMMARY"/>
	<CubeUsage cubeName="SUBMISSIONS_SUMMARY"/>
	<CubeUsage cubeName="UW_REFERRAL_SUMMARY"/>
	<CubeUsage cubeName="OPEN_SUBMISSIONS"/>
	</CubeUsages>
	<VirtualCubeDimension cubeName="POLICY_SUMMARY" name="Policy_Number"/>
	<VirtualCubeDimension cubeName="SUBMISSIONS_SUMMARY" name="Quote"/>
	<VirtualCubeMeasure cubeName="POLICY_SUMMARY" name="[Measures].[Total_Policies]"/>
	<VirtualCubeMeasure cubeName="POLICY_SUMMARY" name="[Measures].[Total_Premium]"/>
	<VirtualCubeMeasure cubeName="SUBMISSIONS_SUMMARY" name="[Measures].[Total_Submissions]"/>
	<VirtualCubeMeasure cubeName="SUBMISSIONS_SUMMARY" name="[Measures].[Total_Submitted_Premium]"/>
	<VirtualCubeMeasure cubeName="UW_REFERRAL_SUMMARY" name="[Measures].[Total_Open_Referral_Count]"/>
	<VirtualCubeMeasure cubeName="OPEN_SUBMISSIONS" name="[Measures].[Total_Open_Submissions]"/>

</VirtualCube>
</Schema>